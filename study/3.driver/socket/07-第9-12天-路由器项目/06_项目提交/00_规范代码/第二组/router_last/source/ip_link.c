#include"ip_link.h"#include "../project/types.h"//函数功能：查找目标ip是否在链表中ARP_LINK *link_search_ip(ARP_LINK *head,char *str){	ARP_LINK *p_mov=head;	while(p_mov!=NULL)	{		if(strcmp(p_mov->ip,str)==0)		{			return p_mov;			}		else		{			p_mov=p_mov->next;		}	}		return NULL;}//函数功能：插入链表并排序void link_insert(ARP_LINK **p_head,ARP_LINK *p_new){	ARP_LINK *pb,*pf;	pb=*p_head;	if(*p_head==NULL)//链表为空	{				*p_head=p_new;		p_new->next=NULL;		return ;	}	while(strcmp(p_new->ip,pb->ip)>0&&pb->next!=NULL)	{		pf=pb;		pb=pb->next;	}	if(strcmp(p_new->ip,pb->ip)==0)	{				memcpy(pb->mac,p_new->mac,18);		return ;	}	else if(strcmp(p_new->ip,pb->ip)<0)	{				if(pb==*p_head)//如果是头结点		{							p_new->next=pb;			*p_head=p_new;		}		else//普通结点		{				pf->next=p_new;			p_new->next=pb;		}	}	else//尾结点	{			pb->next=p_new;		p_new->next=NULL;	}}//函数功能：创建链表void link_create(ARP_LINK **head,ARP_LINK *p_new){	ARP_LINK *p_mov = *head;	if(*head == NULL)//空链表	{		*head = p_new;		p_new->next = NULL;	}	else//不是空链表	{		while(p_mov->next != NULL)		{			p_mov = p_mov->next;		}		p_mov ->next= p_new;		p_new->next =NULL;	}}//函数功能：遍历打印链表void link_print(ARP_LINK * head){		ARP_LINK *p_mov=head;	if(p_mov == NULL)	{		PRINT("此链表为空！\n",RED);	}	while(p_mov!=NULL)	{		printf("ip==%s---------mac==%s\n",p_mov->ip,p_mov->mac);		p_mov=p_mov->next;	}	}//函数功能：创建防火墙链表void filt_link_create(FILT_LINK **p_head,FILT_LINK *p_new){	FILT_LINK *pb;	pb=*p_head;	if(*p_head==NULL)//链表为空	{		*p_head=p_new;		p_new->next=NULL;	}	else //不为空	{		while(pb->next != NULL)		{			pb = pb->next;//找到链表的最后一个节点		}		pb->next = p_new;//把新节点加入		p_new->next =NULL;	}	}//函数功能：遍历查询链表int filt_link_search(FILT_LINK *p_head,char *str){	FILT_LINK *p_mov=p_head;	while(p_mov!=NULL)	{		if(strcmp(p_mov->filt_str,str)==0)		{			return 1;			}		else		{			p_mov=p_mov->next;		}	}	return 0;}//函数功能：遍历打印防火墙信息void filt_link_print(FILT_LINK *p_head){	FILT_LINK *p_mov = p_head;	if(p_mov == NULL)	{		printf("此链表为空\n");	}	while(p_mov!=NULL)	{		printf("%s\n",p_mov->filt_str);		p_mov=p_mov->next;	}}//函数功能：删除防火墙结点int filt_link_delete(FILT_LINK **p_head,char *str){	FILT_LINK* pb,*pf;	pb=*p_head;//让pb指向头节点	if(*p_head == NULL)//链表为空链表	{		system("clear");		PRINT("链表为空，没有要删除的结点",RED);		return 0;	}	while(strcmp(pb->filt_str,str)!= 0 && pb->next!=NULL)//循环查找要删除的节点	{		pf=pb;		pb=pb->next;	}	if(strcmp(pb->filt_str,str) == 0)//找到了一个节点的num和num相等	{		if(pb == *p_head)//找到的节点是头节点		{			*p_head = pb->next;		}		else//找到的节点是普通节点		{			pf->next = pb->next;		}			free(pb);			return 1;	}	else//没有找到要删除的节点	{		system("clear");		PRINT("没有此过滤信息删除\n",RED);		return 0;	}}//函数功能：释放链表void filt_link_free(FILT_LINK **p_head){	FILT_LINK *p_mov;	while(*p_head!=NULL)	{		p_mov=*p_head;		*p_head=p_mov->next;		free(p_mov);	}	PRINT("全部清除成功\n",RED);}