#include <stdio.h>#include <unistd.h>#include <stdlib.h>#include <string.h>#include "arp_link.h"/*************************************************************函数功能:	创建一个链表，或在其尾部插入节点参    数:	ARP链表头地址，节点指针返 回 值:	无*************************************************************/void insert_link(ARP_LINK **head, ARP_LINK *p_new){		ARP_LINK *temp = *head;	//若链表为空,把新节点插入头部	if(*head == NULL)	{			*head = p_new;			p_new->next = NULL;	}	//若链表不为空，先找到链表尾部，把新节点插入链表尾部		else	{		while(memcmp(p_new->arp_ip, temp->arp_ip, 4) != 0 && temp->next != NULL)//链表不存在该节点,则找到链表尾部		{			temp = temp->next;		}		if(memcmp(p_new->arp_ip, temp->arp_ip, 4) == 0)//链表中若存在该节点，则退出			return ;		if(temp->next == NULL)//在尾部插入新节点		{			temp->next = p_new;					p_new->next = NULL;		}	}}/**********************************函数功能:	遍历链表内容参    数:	ARP链表头地址返 回 值:	无**********************************/void print_link(ARP_LINK *head){	ARP_LINK *temp = head;	printf("链表信息：\n");	//循环打印链表信息	while(temp != NULL)	{		printf("ip: %d.%d.%d.%d >> mac: %02x:%02x:%02x:%02x:%02x:%02x\n",			temp->arp_ip[0], temp->arp_ip[1], temp->arp_ip[2], temp->arp_ip[3],//ip地址			temp->arp_mac[0], temp->arp_mac[1], temp->arp_mac[2], 			temp->arp_mac[3], temp->arp_mac[4],temp->arp_mac[5]//mac地址			);		temp = temp->next;//指向下一节点	}}/*******************************************函数功能:	根据ip查找mac参    数:	ARP链表头地址，待查找ip的地址返 回 值:	查找到节点的地址*******************************************/ARP_LINK *ip_find_mac(ARP_LINK *head, unsigned char *ip){	ARP_LINK *mac_addr = head;	//循环比较链表中是否保存了该ip地址	while(mac_addr != NULL)	{		if(memcmp(mac_addr->arp_ip, ip, 4) == 0)//比较ip		{			return mac_addr;//找到则返回该节点地址		}		mac_addr = mac_addr->next;//指向下一节点	}	return NULL;}/***********************************************函数功能:	释放ARP链表参    数:	ARP链表头地址返 回 值:	无***********************************************/void free_arp_link(ARP_LINK *head){	ARP_LINK *temp = head;	while(head)	{		temp = head->next;		free(head);//释放该节点		head = temp;//指向下一节点	}}