  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <meta http-equiv="content-type" content="text/html;charset=gbk"/>
    <meta http-equiv="content-style-type" content="text/css"/>
    <meta http-equiv="content-script-type" content="text/javascript"/>
    <meta name="version" content="neblog-1.0"/>
    <script type="text/javascript">
      
      
      document.uniqueID!=document.uniqueID&&!!location.hash&&(location.hash=location.hash); 
      document.domain = location.hostname.replace(/^.*\.([\w]+\.[\w]+)$/,'$1');
      window.focus();
      window.getMusicTimeStamp=function(){return '8a7910e78874e4f2c7a3a7546b93027a';};
    </script>
<title>vivi 启动过程 - vicyliu1984的日志 - 网易博客</title>
<meta name="author" content="vicyliu1984,vicyliu1984"/>
<meta name="keywords" content="vivi 启动过程,日志,vicyliu1984,X-rain的博客,网易博客,网易,blog"/>
<meta name="description" content="vivi 启动过程,vicyliu1984的网易博客,男人要对自己很一点,男人要对自己狠一点"/>
  <script type="text/javascript">
    (function(){
     var R=24,C=11,a=[];
     for(var i=0;i<C;i++)for(var j=0;j<R;a.push('.icn0-'+i+j+'{background-position:'+(i>0?('-'+i*40+'px'):'0')+' '+(j>0?('-'+j*20+'px'):'0')+';}'),j++);
          document.write('<style type="text/css">'+a.join('')+'</st'+'yle>');
    })();
  </script>
    <link type="text/css" rel="stylesheet" href="http://b2.bst.126.net/newpage/r/c/c.css?v=8183330012"/>
    <link type="text/css" rel="stylesheet" href="http://b.bst.126.net/newpage/style/nblog/4034/nb.css" id="blog-163-com-theme"/>
  <!--[if lte IE 6]>
  <style type="text/css">
    html,body,#blog-163-com-ie6body{height:100%;width:100%;overflow:hidden;}
    #blog-163-com-ie6body{overflow:auto;overflow-y:scroll;}
    #blog-163-com{background:none;}
  </style>
  <![endif]-->
  
  <style type="text/css">.m-3 .nbw-ryt .left .mcnt{padding-left:10px;}.m-3 .nbw-ryt .right .acts{position:relative;margin:0 0 35px 0;line-height:20px;}.m-3 .nbw-ryt .right .more{margin-top:-15px;height:24px;line-height:24px;}#blog-163-com .m-3 .phide{display:none;}.m-3 .nbw-ryt .left .nbw-bitm{margin:0;padding:0 0 0 10px;position:relative;}.m-3 .nbw-ryt .left .nbw-bitm .title{margin:30px 0 20px;}.m-3 .nbw-ryt .left .nbw-bitm .title .tcnt{font-size:20px;font-family:'微软雅黑','黑体',Arial,Helvetica,Sans-Serif;}.m-3 .nbw-ryt .left .nbw-bitm .tdep{margin-bottom:20px;}.m-3 .nbw-ryt .left .nbw-bitm .tbar{margin:5px 0;padding:10px 10px 10px 0;line-height:20px;text-align:right;}.m-3 .nbw-ryt .left .nbw-bitm .bct{font-size:14px;padding-left:0}.m-3 .nbw-ryt .left .nbw-bitm .muava{float:left;margin:5px 7px 0 0;border-width:0 1px 0 0;height:40px;}.m-3 .nbw-ryt .left .snl .pnb div{line-height:20px;text-align:left;}.m-3 .nbw-ryt .cite{margin:20px 0 0 50px;line-height:24px;text-align:left;}.m-3 .nbw-ryt .cite .close{float:right;margin:0;text-align:right;}.m-3 .nbw-ryt .cite span{cursor:pointer;}.m-3 .nbw-ryt .cite .nbw-act{text-align:center;}.m-3 .nbw-ryt .cite .ads{margin-left:20px;width:400px;}.m-3 .nbw-ryt .cite .tbac{margin-left:60px;padding:0;border:0;list-style:none;line-height:24px;}.m-3 .nbw-ryt .cite .tbl{width:150px;overflow:hidden;}.m-3 .nbw-ryt .cite .tbr{margin-left:20px;overflow:hidden;}.m-3 .nbw-act-share{position:relative;}.m-3 .nbw-act-share .nas-wrap{visibility:hidden;}.m-3 .nbw-act-share:hover .nas-wrap,.m-3 .js-share-hover .nas-wrap{visibility:visible;}.m-3 .nas-wrap,.nas-itm,.nas-wb{background:url(/newpage/images/blog/icn-share.png?0010) no-repeat 9999px 9999px;}.m-3 .nas-wrap{margin-top:5px;}.nas-itm,.nas-wb{text-decoration:none;}.nas-itm,.nas-wb:hover{text-decoration:underline;}.m-3 .nas-itm{float:left;width:16px;height:16px;margin:0 1px 0 6px;overflow:hidden;cursor:pointer;}.m-3 .nas-itm0{background-position:0 -173px;}.m-3 .nas-itm1{background-position:0 -56px;}.m-3 .nas-itm2{background-position:0 -85px;}.m-3 .nas-itm3{background-position:0 -227px;}.m-3 .nas-itm4{background-position:0 -143px;}.m-3 .nas-itm5{background-position:0 -201px;}.m-3 .nas-itm6{background-position:0 -249px;}.m-3 .nas-itm7{background-position:0 -283px;}.m-3 .nas-itm8{background-position:0 -313px;}.nas-wb{padding-left:20px;cursor:pointer;line-height:normal;background-position:0 -173px;}.nas-icn0fix{margin-top:4px;}.nas-tofix{margin-top:0;*margin-top:2px;line-height:25px;}.m-3 .ptc{position:absolute;cursor:pointer;}.m-3 .ptc .ptcp .bcmimg{float:left;background-image:url("http://b.bst.126.net/newpage/images/blogcmtimg.png");background-position:0 0;background-repeat:no-repeat;height:22px;line-height:22px;width:22px;padding:0 6px 0 0;}.m-3 .ptc .ptcp{cursor:pointer;position:absolute;left:5px;bottom:5px;clear:both;width:94px;}.m-3 .ptc .ptcp .ptcmi{float:left;width:16px;height:16px;padding:3px 6px 3px 5px;_padding:2px 6px 0 3px;margin:0;}.m-3 .ptc .ptcp .ptcmt{background-position:-418px -50px;float:left;width:67px;height:22px;overflow:hidden;margin:0px 0 0 -3px;line-height:22px;*line-height:23px;text-align:left;color:#444444;}.m-3 .ptc .ptcp .ptcmt-2{width:61px;padding-left:6px;background-position:-424px -50px;}.m-3 .relateblog{text-align:left;}.m-3 .relateblog h4{margin:0;padding:0 0 0 10px;line-height:30px;}.m-3 .relateblog .cnt{padding-left:8px;margin:10px 0 10px 0px;}.m-3 .relateblog .cnt ul{margin:0;padding:0;list-style:none;}.m-3 .relateblog .cnt ul li{height:24px;margin-right:20px;line-height:24px;}.m-3 .relateblog .cnt ul li span{margin:0 8px;}.m-3 .author, .m-3 .comment{text-align:left;}.m-3 .author .nlogif{width:150px;line-height:20px;margin-left:5px;_margin-left:3px;}.m-3 .author .nlogif .nbw-fce{margin:0 3px 0 10px;_margin-left:5px}.m-3 .author .nlogif .pright{width:85px;margin:0;padding:5px 0;_padding-top:10px}.m-3 .nbw-ryt .right h4{margin:0;padding:0;line-height:30px;}.m-3 .author h4, .m-3 .comment h4{margin:0;padding:0 0 0 10px;line-height:30px;}.m-3 .author .cwd{border:0;text-align:left;}.m-3 .author .vname{width:50px;}.m-3 .author .cnt{margin:10px 0 10px -5px;}.m-3 .author .nbw-fce{margin:0 11px;}.m-3 .author .nbw-f50{width:50px}.m-3 .nbw-ryt .left .top{position:relative;padding-bottom:5px;line-height:20px;}.m-3 .nbw-ryt .left .top .ilft{position:absolute;left:0;top:0;}.m-3 .nbw-ryt .left .top .irgt{position:absolute;right:-10px;top:0;}.m-3 .nbw-ryt .left .top .pleft{margin-left:20px;_margin-left:10px;overflow:hidden;width:40%;height:20px;text-align:left}.m-3 .nbw-ryt .left .top .pright{margin-right:10px;_margin-right:5px;overflow:hidden;width:40%;height:20px;text-align:right}.m-3 .nbw-ryt .left .snl .top{position:relative;padding:5px 0 15px 0;line-height:20px;}.m-3 .nbw-ryt .left .snl .top .ilft{position:absolute;left:-10px;top:5px;}.m-3 .nbw-ryt .left .snl .top .irgt{position:absolute;right:-10px;top:5px;}.m-3 .nbw-ryt .left .snl .top .pleft{margin-left:10px;_margin-left:5px;overflow:hidden;width:40%;height:20px;text-align:left}.m-3 .nbw-ryt .left .snl .top .pright{margin-right:10px;_margin-left:5px;overflow:hidden;width:40%;height:20px;text-align:right}.m-3 .nbw-ryt .left .snl .pnb{padding:5px 0 10px 10px;overflow:hidden;_width:100%}.m-3 .comment h4{padding:0 0 0 10px}.m-3 .comment .publish{margin:10px 0;padding:0 0 10px 5px;text-align:left;}.m-3 .comment .publish .nbw-fce{padding-top:0;}.m-3 .comment .publish .nbw-fce .cwd{border:0;}.m-3 .comment .publish .redt{margin-left:65px;}.m-3 .comment .nolog{border:1px solid #000;background-color:#FFFFE1;height:40px;line-height:40px;text-align:center;padding:0;_padding:10px 0;_height:20px;}.m-3 .comment .case{padding-left:5px;padding-bottom:10px;}.m-3 .comment .vgl{margin:8px;width:75%;text-align:center;}#blog-163-com .m-3 .comment .nbw-cmt .cnt{width:488px;}#blog-163-com .m-3 .comment .nbw-cmt .nbw-cmt .cnt{width:444px;}.m-3 .edt-cmt{width:444px;}.m-3 .comment .publish .edt-cmt{width:488px;}.m-3 .comment .publish .edt-cmt .zbcc{display:none;}.m-3 .nbw-ryt .left .nbw-bitm .js-fs0,.m-3 .nbw-ryt .left .nbw-bitm .js-fs0 *{font-size:150%;}.m-3 .nbw-ryt .left .nbw-bitm .js-fs1,.m-3 .nbw-ryt .left .nbw-bitm .js-fs1 *{font-size:130%;}.m-3 .nbw-ryt .left .nbw-bitm .js-fs2,.m-3 .nbw-ryt .left .nbw-bitm .js-fs2 *{}.m-3 .js-fcurrent{font-color:#000;font-weight:bold;text-decoration:none;}.m-3 .nbw-bitm .dream{margin-top:-10px;clear:both}.m-3 .nbw-bitm .cited{margin-top:-15px;}.m-3 .nbw-bitm .rdif{line-height:24px;height:24px;}.m-3 .nbw-bitm .rdif .pnt{line-height:24px;height:24px;margin-right:10px;}.m-3 .nbw-bitm .rdif .pclass{vertical-align:middle;width:57px;height:22px;}.m-3 .nbw-bitm .rdif .rdct{display:inline-block;}.m-3 .snl .rdcnt{padding:5px;text-align:left}.m-3 .snl .rdcnt .nbw-fce{margin:0 5px}.m-3 .snl .rdcnt p{margin:10px 0}.m-3 .snl .rdcnt .rrb{list-style:none;height:22px;line-height:22px;}.m-3 .acts .iblock{width:18px;}.m-3 .ns{margin:0 0 0 2px;}.m-3 .cancel{display:none;}.m-3 .js-hover .cancel, .m-3 .follow:hover .cancel, .m-3 .frd:hover .cancel{display:inline;}.m-3 .follow{*margin-left:2px;}.m-3 .flw{padding:7px 8px;color:#000;background:#fefce4;border:1px solid #b7b7b7;}.m-3 .acts .flw .iblock{width:20px;}.m-3 .sntesctf{width:15px;margin-left:3px;}.dr-warm{width:480px;padding:12px 18px;margin:18px 0;line-height:20px;border:1px solid #aaa;color:#666;background:#ffffdc;}.dr-warm a,.dr-warm a:hover{text-decoration:underline;color:#02a;}.m-3 .commentcntwrap{position:relative;zoom:1;}.m-3 .cmtMultiUserRole{position:absolute;left:62px;bottom:5px;width:300px;overflow-x;hidden;}.m-3 .cmtMultiUserRole .selectRole{float:right;padding:1px 1px 0 1px;border:none;}.m-3 .cmtMultiUserRole .selectRole .ztxt{float:left;width:auto;overflow:hidden;}.m-3 .cmtMultiUserRole .selectRole .zdwn{float:left;background:url("/newpage/images/icon.png") -240px -420px no-repeat;text-indent:-9999px;}.m-3 .cmtMultiUserRole .selectRole .zlst .zitm{}.m-3 .cmtMultiUserRole .selectRole .zlst .zitm:hover, .m-3 .cmtMultiUserRole .selectRole .slst .item.js-zhvr-910{color:#333;background-color:#ececec;}.m-3 .nbw-cmt{position:static;}.m-3 .nbw-cmt .thde{position:relative;zoom:1;}.m-3 .publish .redt{position:relative;zoom:1;}.m-3 .publish .redt .cmtMultiUserRole{left:135px;_left:132px;}.m-3 .cmtMultiUserRole .js-showlist{padding:0;margin:0;border-style:solid;border-width:1px 1px 0 1px;border-color:#aaa;}.m-3 .cmtMultiUserRole .js-showlist .zlst{border-style:solid;border-width:0 1px 1px 1px;border-color:#aaa;}.m-3 .multiuserItem{}.m-3 .multiuserItem .author{margin-right:-50px;}.m-3 .multiuserItem .multicntwrap{padding:30px 0 20px 0;}.m-3 .multiuserItem .multicnt{_padding-top:2px;margin-left:50px;}.m-3 .nbw-ryt .left .multiuserItem .multicnt .title{width:95%;margin-top:0;margin-bottom:0;}.m-3 .nbw-ryt .left .multiuserItem .multicnt .tdep{margin-bottom:0;}.m-3 .attachment{margin-bottom:20px;}.m-3 .awidth{width:40px;}.m-3 .view{margin-right:10px;}.m-3 .nbw-cmt .op{height:18px;line-height:18px;vertical-align:middle;}.m-3 .suggestedreading{overflow:hidden;}.m-3 .suggestedreading .m-list{margin-left:0;padding-left:15px;overflow:hidden;font-size:14px;}.m-3 .suggestedreading .m-list .gap{margin-left:8px;color:#ADADAD;}.m-3 .suggestedreading .m-list li{height:20px;padding:3px 0 2px;vertical-align:middle;}.m-3 .suggestedreading .wrap li{float:left;width:118px;height:146px;}.m-3 .suggestedreading .suggesteditem1{line-height:24px;margin:5px 0;font-size:12px;margin-right:10px;}.m-3 .suggestedreading .suggesteditem2{margin:5px 0;font-size:12px;}.m-3 .suggestedreading .suggesteditem2 .imgwrap1{position:relative;overflow:hidden;width:90px;height:90px;}.m-3 .suggestedreading .suggesteditem2 .imgwrap2{z-index:2;position:absolute;left:0;top:0;}.m-3 .suggestedreading .suggesteditem2 .btitle{width:96px;height:148px;overflow:hidden;text-decoration:none;}.m-3 .suggestedreading .suggesteditem2 .sep{padding:5px 10px 0 10px;}.m-3 .suggestedreading .suggesteditem2 a{cursor:pointer;}.m-3 .suggestedreading .suggesteditem2 a:hover{text-decoration:none;}.m-3 .suggestedreading .suggesteditem2 img{border-width:0;}.m-3 .suggestedreading .color1{background-color:#B3786B;}.m-3 .suggestedreading .color2{background-color:#D2C1A8;}.m-3 .suggestedreading .color3{background-color:#D46646;}.m-3 .suggestedreading .color4{background-color:#D28FA8;}.m-3 .suggestedreading .color5{background-color:#C84F54;}.m-3 .suggestedreading .white{color:white;}.m-3 .suggestedreading .imgtip{margin:2px;font-weight:bold;color:white;font-size:13px;font-family:微软雅黑;}.m-3 .suggestedreading .borderwrap{padding:2px;background-color:#fff;}.m-3 .suggestedreading .time{position:absolute;bottom:0;right:0;}.m-3 .suggestedreading .hidsep{margin-left:-1px;}.m-3 .suggestedreading .srtitle{font-size:14px;font-weight:bold;margin-bottom:10px;}.m-3 #yodaoad{padding-left:5px;}.m-3 .relategroup{width:45%}.m-3 .blogvote{padding-left:35px;}.m-3 .blogvote .sep{margin:0 5px;}.m-3 .blogvote .vtitle{margin:15px 0 15px -30px;}.m-3 .blogvote .vtitle span{padding-right:8px;}.m-3 .blogvote .vtitle .close{width:60px;height:24px;vertical-align:middle;}.m-3 .blogvote .roleview{padding-right:10px}.m-3 .blogvote .roleview .iblock{width:10px}.m-3 .blogvote .options{clear:both;margin-right:10px}.m-3 .blogvote .options ul{margin:0;padding:0;list-style:none;}.m-3 .blogvote .options ul li{padding:10px 0;line-height:16px;}.m-3 .blogvote .options .role{margin-bottom:15px;}.m-3 .blogvote .options .acts{margin-bottom:15px;}.m-3 .blogvote .options .acts .view{margin-left:5px;}.m-3 .blogvote .fvote{padding-top:10px;}.m-3 .blogvote .fvote ul{list-style:none;margin:10px 0;padding:0;}.m-3 .blogvote .fvote ul li{height:20px;margin:5px 0;}.m-3 .blogvote .options ul .col0{width:230px;margin-right:10px;margin-top:-3px;_margin-top:-5px;line-height:20px}.m-3 .blogvote .options ul .col0 input{_position:relative;_top:3px}.m-3 .blogvote .options ul .col0 label{width:200px;_position:relative;_top:4px}.m-3 .blogvote .options ul .col1{width:190px;height:14px;line-height:14px;;background:none repeat scroll 0 0 #EAEAEA;}.m-3 .blogvote .options ul .col1 .iblock{width:100%;height:16px;vertical-align:middle;}</style>
  </head>
<body id="blog-163-com" class="nb-body nb-inr nb-prv">
  <!--[if lte IE 6]><div id="blog-163-com-ie6bodywrap" class=""><![endif]-->
    <!--[if lte IE 6]><div id="blog-163-com-ie6body" class="nb-body"><![endif]-->

<div class="nb-nbar clearfix" id="blog-163-com-topbar">
  <div class="pl fl clearfix">
  <div id=""" class="nbw-im fl im im0">
    <a class="lbl bd ia noul " href="http://blog.163.com/redirect.html?frompersonalbloghome&amp;url=http://www.163.com/" target="_blank" hidefocus="true"><span class="tx">网易</span><span class="iblock icn0 icn0-421">&nbsp;</span></a><div class="nbw-tcd box-shadow bd">
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/redirect.html?frompersonalbloghome&amp;url=http://news.163.com/">
            新闻
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/redirect.html?frompersonalbloghome&amp;url=http://t.163.com/">
            微博
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/redirect.html?frompersonalbloghome&amp;url=http://email.163.com/">
            邮箱
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/redirect.html?frompersonalbloghome&amp;url=http://fm.163.com/?fmblogzx0628">
            闪电邮
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/redirect.html?frompersonalbloghome&amp;url=http://photo.163.com/">
            相册
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/redirect.html?frompersonalbloghome&amp;url=http://www.youdao.com/">
            有道
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://m.123.163.com/?frombkcp">
            手机邮
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/redirect.html?frompersonalbloghome&amp;url=http://yxp.163.com/">
            印像派
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/redirect.html?frompersonalbloghome&amp;url=http://dream.163.com/?from=bkcp">
            梦幻人生
          </a>
        <div class="sep bd space">&nbsp;</div>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/redirect.html?frompersonalbloghome&amp;url=http://sitemap.163.com/">
            更多
          </a>
        
    </div>
  </div>
  <div id=""" class="nbw-im fl im im10">
    <a class="lbl bd ia noul " href="http://blog.163.com/?frompersonalbloghome" target="_blank" hidefocus="true"><span class="tx">博客</span><span class="iblock icn0 icn0-421">&nbsp;</span></a><div class="nbw-tcd box-shadow bd">
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/?frompersonalbloghome">
            博客首页
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/ht/?frompersonalbloghome">
            博客话题
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/hot/history/?frompersonalbloghome">
            热点专题
          </a>
          <a   class="itm noul youcai " target="_blank" hidefocus="true" href="http://blog.163.com/BLOG_YOUCAI/">
            博客油菜地
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/findFriend.do?type=5?frompersonalbloghome">
            找朋友
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://q.163.com/#home?frompersonalbloghome">
            博客圈子
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/public/theme/?frompersonalbloghome">
            博客风格
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/services/wapblog.html?frompersonalbloghome">
            手机博客
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/services/emsblog.html?frompersonalbloghome">
            短信写博
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/services/mailblog.html?frompersonalbloghome">
            邮件写博
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/clone/clone.html?frompersonalbloghome">
            博客复制
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://blog.163.com/showMultiUser.do?frompersonalbloghome">
            群博客
          </a>
        
    </div>
  </div>
  <div id=""" class="nbw-im fl im im10">
    <a class="lbl bd ia noul " href="http://photo.163.com/pp/square/?frompersonalbloghome" target="_blank" hidefocus="true"><span class="tx">摄影</span><span class="iblock icn0 icn0-421">&nbsp;</span></a><div class="nbw-tcd box-shadow bd">
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://photo.163.com/pp/?frompersonalbloghome">
            主题展区
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://photo.163.com/pp/like/?frompersonalbloghome">
            喜欢好图
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://photo.163.com/pp/sharepick/?frompersonalbloghome">
            每月精选
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://photo.163.com/pp/zhuanti.html?frompersonalbloghome">
            每日专题
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://photo.163.com/pp/fotoshow/list/">
            影像故事
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://photo.163.com/pp/advance/?frompersonalbloghome">
            高级拍客
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://photo.163.com/pp/star/">
            摄影人物志
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://photo.163.com/pp/interview/list/">
            摄影师专访
          </a>
          <a   class="itm noul  " target="_blank" hidefocus="true" href="http://photo.163.com/pp/dianping/list/">
            摄影点评
          </a>
        
    </div>
  </div>
    
    
    <div class="nbw-im fl im1 im seebyway"><a class="lbl bd ima spy" href="http://blog.163.com/classify/index.do">发现好博客</a></div>
    
    <span class="fl iblock space icn1 icn1-4">&nbsp;</span>
    <div id="topbar_randShowArea" class="fl">
      <div class="nbw-im fl im1 im randtag"><a style="width:80px" target="_blank" class="lbl bd ima moveblog randshow" href="http://blog.163.com/showMultiUser.do">群博客召集令</a></div>
    </div>
  </div>
  <div class="fr pr clearfix">
    <div id="topbar_loginAndReg" class="fr">
      <a class="iblock fr ima" href="http://reg.163.com/reg/reg0_new.jsp?product=blog&url=http://blog.163.com/ntesRegBlank.html" target="_blank">注册</a>
      <span class="fr iblock space icn1 icn1-4 spx">&nbsp;</span>
      <a class="iblock fr ima ztag" href="#">登录</a>
    </div>
  </div>
</div>
<script type="text/javascript">
  (function(){
      var e = document.getElementById('blog-163-com-main');
      if(!!e) e.parentNode.insertBefore(document.getElementById('blog-163-com-topbar'),e);
      e = document.getElementById('blog-notice-email');
      if(!!e) window.setTimeout(function(){e.style.display='';},50);
  })()
</script>
<div class="blogtoptips phide" id="blog-163-com-toptips">
 <div class="blogtoptipswrap">
    <div id="newbulletinstip" class="newbulletinstip phide">
    <a class="lnknews fc03 m2a tiptag phide" href="" target="_blank"></a><span class="txtnews tiptag phide"></span>&nbsp;&nbsp;&nbsp;<a class="fc03 ul nextorprevnews tiptag phide" href="" hidefocus="true">显示下一条</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a class="fc03 ul close tiptag" href="" hidefocus="true">关闭</a>
  </div>
 </div>
    <div id="istyletip" class="istyletip phide">
      <img src="/newpage/images/istyletip-1.png" usemap="#istylemap" border="0px"/>
      <map name="istylemap">
		<area shape="rect" coords="780,13,865,34" href="http://istyle.163.com/?fromblogbanner" target="_blank" title="去社区看看">
		<area class="istyletag m2a" shape="rect" coords="880,15,910,32" href="#" title="关闭">
	  </map>
    </div>
    <div id="$_sheyingtip" class="sheyingtip phide">
      <img src="/newpage/images/sheyingtip.png" usemap="#sheyingmap" border="0px"/>
      <map name="sheyingmap">
		<area shape="rect" coords="780,13,865,34" href="http://blog.163.com/blog_admin/blog/static/721279201122411125925/?fromblogbanner" target="_blank" title="了解详情">
		<area class="sheyingtag m2a" shape="rect" coords="880,15,910,32" href="#" title="关闭">
	  </map>
    </div>
    <div id="$_faxiantip" class="faxiantip phide">
      <img style="margin-top:2px;" src="/newpage/images/faxiantip.png" usemap="#faxianmap" border="0px"/>
      <map name="faxianmap">
		<area shape="rect" coords="595,12,680,31" href="http://blog.163.com/classify/index.do?fromblogbanner" target="_blank" title="查看特权">
		<area class="faxiantag m2a" shape="rect" coords="690,12,720,31" href="#" title="关闭">
	  </map>
    </div>
</div>  <div class="nb-wrap wsy" id="blog-163-com-main"><div class="nb-are nb-top">
  <div class="wkg h" id="blog-163-com-banner">
    
    <div class="t">
      <h1 class="n c"><span class="ztag pre">X-rain的博客</span></h1>
      <p class="d c"><span class="ztag pre">男人要对自己很一点</span></p>
    </div>
    <div class="f h ztag"></div>
    <a class="x" hidefocus="true" target="_blank" href="#"><span class="xx ztag"></span></a>
  </div>
</div><div class="nb-are nb-nav">
  <div class="wkg">
    <div class="c h">
      <h2>导航</h2>
      <ul class="noul clearfix">
                
	        <li class="w w0">
	          <a class="i i0 fc01 h" hidefocus="true" href="http://vicyliu1984.blog.163.com/">首页</a>
	        </li>
	        <li class="w w1 selected">
	          <a class="i i1 fc01 h" hidefocus="true" href="http://vicyliu1984.blog.163.com/blog/">日志</a>
	        </li>
	        <li class="w w2">
	          <a class="i i2 fc01 h" hidefocus="true" href="http://vicyliu1984.blog.163.com/album/">相册</a>
	        </li>
	        <li class="w w3">
	          <a class="i i3 fc01 h" hidefocus="true" href="http://vicyliu1984.blog.163.com/music/">音乐</a>
	        </li>
	        <li class="w w4">
	          <a class="i i4 fc01 h" hidefocus="true" href="http://vicyliu1984.blog.163.com/collection/">收藏</a>
	        </li>
	        <li class="w w5">
	          <a class="i i5 fc01 h" hidefocus="true" href="http://vicyliu1984.blog.163.com/friends/">博友</a>
	        </li>
	        <li class="w w6">
	          <a class="i i6 fc01 h" hidefocus="true" href="http://vicyliu1984.blog.163.com/profile/">关于我</a>
	        </li>
      </ul><!--
 --></div>
    <div class="l h">&nbsp;</div>
    <div class="r h">&nbsp;</div>
  </div>
</div>  <div class="nb-are nb-smt"><div class="wkg h space"><div class="l h">&nbsp;</div><div class="r h">&nbsp;</div><div class="c h">&nbsp;</div></div></div>
  <div class="nb-are nb-cnt">
    <div class="wkg">
      <div class="c wc h clearfix " id="blog-163-com-container">  <div class="nb-mdl lcr m-3" id="-3">
  <div class="nb-mt lcr th fc02">
    <div class="c tc th lcr"><h2 class="thide nb-jsc">日志</h2></div>
    <div class="r tm th nb-jsc"></div>
    <div class="l tl th">&nbsp;</div>
    <div class="r tr th">&nbsp;</div>
  </div>
    <div class="nb-mc lcr">
      <div class="c cc lcr nb-jsc"><script>
function g_onSuggestedReadingImgLoad(_img){
    var image = new Image();
    image.src = _img.src;
    var _width = 90;
    var _height = 90;
    if(image.width > image.height){
    	_img.style.marginLeft = -Math.floor((image.width*(_height/image.height)-_width)/2)+'px';
    	_img.style.height = _height+'px';
    }else {
    	_img.style.width = _width+'px';
    	_img.style.marginTop = -Math.floor((image.height*(_width/image.width)-_height)/2)+'px';
    }
    _img.style.display = 'block';
}
</script>
<div class="nbw-ryt ztag clearfix ">
  <div class="right bdwl bds0 bdc0"><div class="cnt ztag"></div></div>
  <div class="left">
     <div class="lcnt bdwr bds0 bdc0 ">   
      <div id="$_divTopLink" class='top fc03 bdwb bdc0 bds2 clearfix'>
        <span class="ilft iblock icn0 icn0-620">&nbsp;</span>
        <div class="pleft thide"><a class="m2a"  href="http://vicyliu1984.blog.163.com/blog/static/31541232201010345730363/">vivi 的目录结构</a></div>
        <span class="irgt iblock icn0 icn0-619">&nbsp;</span>
        <div class="pright thide"><a class="m2a" href="http://vicyliu1984.blog.163.com/blog/static/315412322010103101313157/">U-Boot 的移植</a></div>
     </div> 
     <div class="mcnt ztag"> 
      <div class="nbw-bitm bdwb bds2 bdc0 ">
        <div class="multicntwrap">
	      <div class="multicnt">
	      	<div>
		      <h3 class="title pre fs1"><span class="tcnt">vivi 启动过程</span><span class="bgc0 fc07 fw0 fs0"></span></h3>
		      <p class="tdep clearfix nbw-act fc06" style="line-height:20px;">
		        <span class="pleft">
		          <a class="fc03 m2a" href="http://vicyliu1984.blog.163.com/blog/#m=0&t=1&c=fks_084066087081081067082094086095087087084071085084085065" title="vivi">vivi</a>
		          <span class="sep">2010-11-03 20:31:52</span>
		          <span class="sep">阅读<span id="$_spanReadCount">55</span></span>
		          <span class="sep">评论<span id="$_spanCommentCount">0</span></span>
		        </span>
		        <span class="pright fc07 ztag"><span class="sep"></span>&nbsp;&nbsp;字号：<span class="ul sep fc04">大</span><span  class="ul sep fc04" >中</span><span  class="sep ul fc04" >小</span></span><span class="pright pnt fc03" id="$_blog_subscribe"><span class="iblock icn0 icn0-919">&nbsp;</span><a class="m2a">订阅</a></span>
		      </p>
		    </div>
	      </div>
        </div>
        
        <div>
        
        </div>
        
        <div class="bct fc05 fc11 nbw-blog ztag"><P><STRONG><FONT size=3>1. vivi 启动的第一阶段</FONT></STRONG></P>
<P>&nbsp;&nbsp;&nbsp; 第一阶段完成含依赖于 CPU 的体系结构硬件初始化的代码，包括禁止中断、初始化串口、复制自身到RAM 等。相关代码集中在head.S （arch\your-arch\目录下)。第一阶段中按先后顺序完成下面8项任务：</P>
<P>(1)&nbsp;关闭watch dog。因为上电之后watch dog 默认是打开的。实现的代码如下：</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;@ disable watch dog timer&nbsp; ；禁止看门狗计时器<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r1, #0x53000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ；WTCON&nbsp;寄存器地址是0x53000000，清0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r2, #0x0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;r2, [r1]</P>
<P>(2) 禁止所有中断</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ disable all interrupts<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r1, #INT_CTL_BASE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r2, #0xffffffff<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oINTMSK]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ；掩码关闭所有中断<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2, =0x7ff<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oINTSUBMSK]</P>
<P>(3) 初始化系统时钟</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 启动 MPLL，FCLK=200MHz，HCLK=100MHz，PCLK=50MHz，"CPU bus mode" 改为 " Asynchronous bus mode"。</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ initialise system clocks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;；初始化系统时钟<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r1, #CLK_CTL_BASE<BR>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;mvn&nbsp;r2, #0xff000000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oLOCKTIME]<BR>&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;mov&nbsp;r1, #CLK_CTL_BASE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2, clkdivn_value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oCLKDIVN]</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;mrc&nbsp;p15, 0, r1, c1, c0, 0&nbsp;&nbsp;@ read ctrl register <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; orr&nbsp;r1, r1, #0xc0000000&nbsp;&nbsp;@ Asynchronous&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mcr&nbsp;p15, 0, r1, c1, c0, 0&nbsp;&nbsp;@ write ctrl register</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r1, #CLK_CTL_BASE<BR>&nbsp;&nbsp; &nbsp;&nbsp; @ldr&nbsp;r2, mpll_value&nbsp;&nbsp;&nbsp;@ clock default<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr &nbsp;r2, =0x7f021&nbsp;@mpll_value_USER &nbsp;&nbsp;@ clock user set<BR>&nbsp;&nbsp; &nbsp;&nbsp; str&nbsp;r2, [r1, #oMPLLCON]<BR>&nbsp;&nbsp; &nbsp;&nbsp; bl&nbsp;memsetup</P>
<P>(4) 初始化内存控制器寄存器</P>
<P>ENTRY(memsetup)<BR>&nbsp;&nbsp;&nbsp; &nbsp; @ initialise the static memory </P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ set memory control registers<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r1, #MEM_CTL_BASE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; adrl&nbsp;r2, mem_cfg_val<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;r3, r1, #52<BR>&nbsp; 1:&nbsp;ldr&nbsp;r4, [r2], #4<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r4, [r1], #4<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;r1, r3<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bne&nbsp;1b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;pc, lr</P>
<P>(5) 点亮所有LED</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ All LED on<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r1, #GPIO_CTL_BASE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;r1, r1, #oGPIO_F<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2,=0x55aa<BR>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;str&nbsp;r2, [r1, #oGPIO_CON]<BR>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;mov&nbsp;r2, #0xff<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oGPIO_UP]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r2, #0x00<BR>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;str&nbsp;r2, [r1, #oGPIO_DAT]</P>
<P>(6) 初始化 UART0</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (1. 设置GPIO，选择UART0 使用的引脚</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ set GPIO for UART<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r1, #GPIO_CTL_BASE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;r1, r1, #oGPIO_H<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldr&nbsp;r2, gpio_con_uart&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;r2, [r1, #oGPIO_CON]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2, gpio_up_uart<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oGPIO_UP]</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bl&nbsp;InitUART</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (2. 初始化UART0</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ inital values for GPIO<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gpio_con_uart:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.long&nbsp;vGPHCON<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gpio_up_uart:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .long&nbsp;vGPHUP</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(3.&nbsp;设置串口工作方式、波特率、是否流控</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ Initialize UART<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ r0 = number of UART port</P>
<P>InitUART:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r1, SerBase<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r2, #0x0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oUFCON]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oUMCON]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r2, #0x3<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oULCON]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2, =0x245<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oUCON]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #define UART_BRD ((UART_PCLK&nbsp; / (UART_BAUD_RATE * 16)) - 1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r2, #UART_BRD<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oUBRDIV]</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r3, #100<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r2, #0x0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1:&nbsp;sub&nbsp;r3, r3, #0x1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tst&nbsp;r2, r3<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bne&nbsp;1b</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #if 0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r2, #'U'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oUTXHL]</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1:&nbsp;ldr&nbsp;r3, [r1, #oUTRSTAT]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and&nbsp;r3, r3, #UTRSTAT_TX_EMPTY<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tst&nbsp;r3, #UTRSTAT_TX_EMPTY<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bne&nbsp;1b&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r2, #'0'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;str&nbsp;r2, [r1, #oUTXHL]</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1:&nbsp;ldr&nbsp;r3, [r1, #oUTRSTAT]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and&nbsp;r3, r3, #UTRSTAT_TX_EMPTY<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tst&nbsp;r3, #UTRSTAT_TX_EMPTY<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bne&nbsp;1b&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endif</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;pc, lr</P>
<P>(7) 复制vivi 的代码</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; 将vivi 所有代码（包括阶段1 和阶段2）从nand flash 复制到SDRAM，包括5个步骤：</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; (1. 设置nand flash 控制寄存器</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ reset NAND<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r1, #NAND_CTL_BASE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;ldr&nbsp;r2, =( (7&lt;&lt;12)|(7&lt;&lt;8)|(7&lt;&lt;4)|(0&lt;&lt;0) )<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; str&nbsp;r2, [r1, #oNFCONF]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2, [r1, #oNFCONF]</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2, =( (1&lt;&lt;4)|(0&lt;&lt;1)|(1&lt;&lt;0) ) @ Active low CE Control&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;r2, [r1, #oNFCONT]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2, [r1, #oNFCONT]</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2, =(0x6)&nbsp;&nbsp;@ RnB Clear<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;r2, [r1, #oNFSTAT]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2, [r1, #oNFSTAT]<BR>&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; mov&nbsp;r2, #0xff&nbsp;&nbsp;@ RESET command<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strb&nbsp;r2, [r1, #oNFCMD]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r3, #0&nbsp;&nbsp;&nbsp;@ wait <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1:&nbsp;add&nbsp;r3, r3, #0x1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;r3, #0xa<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blt&nbsp;1b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2:&nbsp;ldr&nbsp;r2, [r1, #oNFSTAT]&nbsp;@ wait ready<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tst&nbsp;r2, #0x4<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; beq&nbsp;2b</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r2, [r1, #oNFCONT]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; orr&nbsp;r2, r2, #0x2&nbsp;&nbsp;@ Flash Memory Chip Disable<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str&nbsp;r2, [r1, #oNFCONT]</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; (2. 设置堆栈指针</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ldr&nbsp;sp, DW_STACK_START&nbsp;@ setup stack pointer</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(3.&nbsp;设置即将调用的函数 nand_read_ll 的参数</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; r0：表示目的地址（SDRAM 的地址）</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; r1：表示源地址（nand flash 的地址）</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r2：表示复制的长度（以字节为单位）</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ copy vivi to RAM<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r0, =VIVI_RAM_BASE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp; r1, #0x0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r2, #0x20000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(4. 调用nand_read_ll 进行复制， r0, r1, r2 分别为函数的三个参数；从NAND Flash 的 0地址复制128k 到SDRAM&nbsp;指定处</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bl&nbsp;nand_read_ll</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;函数nand_read_ll() 在 vivi/arch/s3c2440/nand_read.c中定义</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(5. 进行一些检查工作：上电后 nand&nbsp;flash&nbsp;最开始的 4K&nbsp;代码被自动复制到一个称为 "Steppingstone"&nbsp;的内部RAM 中（地址为 0x00000000-0x00001000)；在执行 nand_read_ll 之后，这 4K 代码同样被复制到 SDRAM 中 (地址0x33f00000-0x33f01000)。比较这两处的4K 代码，如果不同则表示出错：</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ verify<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r0, #0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;r1, =0x33f00000<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;r2, #0x400&nbsp;@ 4 bytes * 1024 = 4K-bytes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>(8)&nbsp;跳到Boot Loader 的stage 2 (main) 运行</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ get read to call C functions<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ldr&nbsp;sp, DW_STACK_START&nbsp;@ setup stack pointer<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;fp, #0&nbsp;&nbsp;&nbsp;@ no previous frame, so fp=0<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;a2, #0&nbsp;&nbsp;&nbsp;@ set argv to NULL </P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bl&nbsp;main&nbsp;&nbsp;&nbsp;@ call main </P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;pc, #FLASH_BASE&nbsp;&nbsp;@ otherwise, reboot&nbsp;</P>
<P>&nbsp;</P>
<P><STRONG><FONT size=3>2. vivi 启动的第二阶段</FONT></STRONG></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vivi的第二阶段是从 main() 函数开始，同一般C 语言程序一样，该函数在 /init/main.c 文件中，总共可以分为8个步骤：</P>
<P>(1) 函数开始，通过pustr(vivi_banner) 打印出vivi 的版本，vivi_banner 在 init/version.c 文件中定义。然后调用 reset_handler() 函数将内存清零，该函数定义在 /lib/reset_handle.c 中。</P>
<P>(2)&nbsp;对开发者进行初始化，主要完成两个功能，时钟初始化和通用 I/O 口设置。这些任务通过调用 board_init()&nbsp;函数来完成。board_init 是与开发板密切相关的，这个函数在 /arch/your-arch/smdk.c文件中。</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int board_init(void)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;init_time();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set_gpios();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;init_time() 函数只是简单的令寄存器 TCFG0=0xf00，vivi 未使用定时器，这个函数可以忽略</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set_gpios() 函数用于选择 GPA-GPH&nbsp;端口各引脚的功能及是否使用各引脚的内部上位电阻，并设置外部中断源寄存器 EXTINT0-2&nbsp;</P>
<P>(3)&nbsp;建立页表和启动 MMU。这个工作分别由两个函数来完成，mem_map_init() 和 mmu_init()，这两个函数都定义在 /arch/s3c2410/mmu.c 文件中</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mem_map_init() 函数的代码为：</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void mem_map_init(void)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ifdef CONFIG_S3C2440_NAND_BOOT<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mem_map_nand_boot();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mem_map_nor();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endif<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cache_clean_invalidate();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tlb_invalidate();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; 如果配置 vivi 使用了 NAND 作为启动设备，则执行 mem_nand_boot()，否则执行 mem_map_nor().</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; mem_map_nand_boot() 函数调用 mem_mapping_linear() 函数来最终完成建立页表工作。页表存放在SDRAM 物理地址 0x33dfc000 开始处，共16KB。一页表项 4 字节，共有4096 个页表项；每个页表项对应 1MB 地址空间，共 4GB。mem_map_init() 先将 4GB 虚拟地址映射到相同的物理地址上，NCNB (不使用 cache，不使用 write buffer)，这样，对寄存器的操作跟未启动 MMU 时是一个样的；再将 SDRAM 对应的64MB 空间的页表修改为使用cache。</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 如果使用NOR启动，则必须先把 vivi 代码复制到 RAM 中。这个过程是由 copy_vivi_to_ram() 函数来完成的。该函数的代码如下：</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void copy_vivi_to_ram(void)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; putstr_hex("Evacuating 1MB of Flash to DRAM at 0x", VIVI_RAM_BASE);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memcpy((void *)VIVI_RAM_BASE, (void *)VIVI_ROM_BASE, VIVI_RAM_SIZE);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VIVI_RAM_BASE、VIVI_ROM_BASE、VIVI_RAM_SIZE这些值都可以在&nbsp;your-arch.h 中查到，并且这些值必须根据自己开发的RAM 实际大小修改。这也是在移植&nbsp;vivi 的过程中需要注意的一个地方。</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mmu_init() 函数中执行了 arm920_setup()&nbsp;函数。这段代码是用汇编语言实现的，针对 arm920t 核的处理器，其代码如下：</P>
<P>static inline void arm920_setup(void)<BR>{<BR>&nbsp;unsigned long ttb = MMU_TABLE_BASE;</P>
<P>__asm__(<BR>&nbsp;/* Invalidate caches */<BR>&nbsp;"mov&nbsp;r0, #0\n"<BR>&nbsp;"mcr&nbsp;p15, 0, r0, c7, c7, 0\n"&nbsp;/* invalidate I,D caches on v4 */<BR>&nbsp;"mcr&nbsp;p15, 0, r0, c7, c10, 4\n"&nbsp;/* drain write buffer on v4 */<BR>&nbsp;"mcr&nbsp;p15, 0, r0, c8, c7, 0\n"&nbsp;/* invalidate I,D TLBs on v4 */<BR>&nbsp;/* Load page table pointer */<BR>&nbsp;"mov&nbsp;r4, %0\n"<BR>&nbsp;"mcr&nbsp;p15, 0, r4, c2, c0, 0\n"&nbsp;/* load page table pointer */<BR>&nbsp;/* Write domain id (cp15_r3) */<BR>&nbsp;"mvn&nbsp;r0, #0\n"&nbsp;&nbsp;&nbsp;/* Domains 0, 1 = client */<BR>&nbsp;"mcr&nbsp;p15, 0, r0, c3, c0, 0\n"&nbsp;/* load domain access register */<BR>&nbsp;/* Set control register v4 */<BR>&nbsp;"mrc&nbsp;p15, 0, r0, c1, c0, 0\n"&nbsp;/* get control register v4 */<BR>&nbsp;/* Clear out 'unwanted' bits (then put them in if we need them) */<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* .RVI ..RS B... .CAM */ <BR>&nbsp;"bic&nbsp;r0, r0, #0x3000\n"&nbsp;&nbsp;/* ..11 .... .... .... */<BR>&nbsp;"bic&nbsp;r0, r0, #0x0300\n"&nbsp;&nbsp;/* .... ..11 .... .... */<BR>&nbsp;"bic&nbsp;r0, r0, #0x0087\n"&nbsp;&nbsp;/* .... .... 1... .111 */<BR>&nbsp;/* Turn on what we want */<BR>&nbsp;/* Fault checking enabled */<BR>&nbsp;"orr&nbsp;r0, r0, #0x0002\n"&nbsp;&nbsp;/* .... .... .... ..1. */<BR>#ifdef CONFIG_CPU_D_CACHE_ON<BR>&nbsp;"orr&nbsp;r0, r0, #0x0004\n"&nbsp;&nbsp;/* .... .... .... .1.. */<BR>#endif&nbsp; <BR>#ifdef CONFIG_CPU_I_CACHE_ON <BR>&nbsp;"orr&nbsp;r0, r0, #0x1000\n"&nbsp;&nbsp;/* ...1 .... .... .... */<BR>#endif&nbsp; <BR>&nbsp;/* MMU enabled */<BR>&nbsp;"orr&nbsp;r0, r0, #0x0001\n"&nbsp;&nbsp;/* .... .... .... ...1 */<BR>&nbsp;"mcr&nbsp;p15, 0, r0, c1, c0, 0\n"&nbsp;/* write control register */<BR>&nbsp;: /* no outputs */<BR>&nbsp;: "r" (ttb) );<BR>}&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp; </P>
<P>(4) 初始化堆栈，heap_init()。（定义在 /lib/heap.c 文件中）</P>
<P>int heap_init(void)<BR>{<BR>&nbsp;return mmalloc_init((unsigned char *)(HEAP_BASE), HEAP_SIZE);&nbsp;<BR>}</P>
<P>&nbsp;&nbsp;&nbsp; heap_init() 函数在SDRAM 中指定了一块 1MB 大小的内存作为 heap (起始地址 HEAP_BASE=0x33e00000），并在 heap 的开头定义了一个数据结构 blockhead――事实上，heap 就是使用一系列的 blockhead 函数结构来描述和操作的。每个 blockhead 数据结构对应一个块 heap 内存，假设一个 blockhead 数据结构的存放位置为 A，则它对应的可分配内存地址为 "A+sizeof(blockhead)" 到 "A+sizeof(blockhead)+size-1”。</P>
<P>&nbsp;&nbsp;&nbsp; Vivi 对 heap 的操作比较简单，vivi 中的一个全局变量 static blockhead*gHeapBase，它是Heap 的链表头指针，通过它可以便利所有 blockhead 数据结构。假设需要动态申请一块 sizeA 大小的内存，则 mmalloc() 函数从 gHeapBase 开始搜索 blockhead 数据结构，如果发现某个blockhead，放入链表中，同时返回分配的内存的首地址。而释放内存的操作更简单，直接将要释放的内存对应的blockhead 数据结构的 allocated 设为 0 即可。</P>
<P>&nbsp;</P>
<P>(5) 初始化MTD设备，需要调用 mtd_dev_init() 函数，代码乳如下：</P>
<P>int mtd_init(void)<BR>{<BR>&nbsp;int ret;</P>
<P>#ifdef CONFIG_MTD_CFI<BR>&nbsp;ret = cfi_init();<BR>#endif<BR>#ifdef CONFIG_MTD_SMC<BR>&nbsp;ret = smc_init();<BR>#endif<BR>#ifdef CONFIG_S3C2440_AMD_BOOT<BR>&nbsp;ret = amd_init();<BR>#endif</P>
<P>&nbsp;if (ret) {<BR>mymtd = NULL;<BR>return ret;<BR>}<BR>return 0;<BR>}</P>
<P>&nbsp;&nbsp;&nbsp; 在Linux 系统中，通常会用到不同的存储设备，特别是Flash 设备。为了在使用新的存储设备时，能更简便地提供它的驱动程序，在上层应用和硬件驱动的中间，抽象出 MTD (Memory Technology Device) 设备层。驱动层不必关心存储的数据格式如何，例如是FAT32、EXT2 还是 JFFS2 或其他。它仅仅提供一些简单的接口，例如读写、擦除及查询。如何组织数据，则是上层应用的事情。MTD 层将驱动层提供的函数封装起来，向上层提供统一的接口。这样，上层即可专注于文件系统的实现，而不必关心存储设备的具体操作。该函数可以在 /drivers/mtd/maps/your-arch_flash.c里找到。</P>
<P>(6) 初始化私有数据，要用到 init_priv_data() 函数，该函数定义在/lib/priv_data/rw.c文件中。此函数将启动内核的命令参数取出，存放在内存特定的位置中。这些参数来源有两个：vivi 预设的默认参数和用户设置的参数（存放在nand flash上）。init_priv_data&nbsp; 先读出默认参数，存放在“VIVI_PRIV_RAM_BASE” 开始的内存上；然后读取用户参数，如果成功，则用户参数覆盖默认参数，否则使用默认参数。</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; init_priv_data() 函数分别调用 get_default_priv_data() 函数和 load_saved_priv_data() 函数来读取默认参数和用户参数。这些参数分别为以下三类：vivi 自身使用的一些参数，例如传输文件时使用的协议等；Linux 启动命令；nand flash 的分区参数。</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get_default_priv_data() 函数比较简单，它将vivi 中存储这些默认参数的变量复制到指定的内存中，load_saved_priv_data() 函数从Flash 上读出这些参数的内容，然后将他们复制到指定的内存中。</P>
<P>(7) 初始化内置命令，misc() 和 init_builtin_cmds() 函数。这两个函数都是简单地调用 add_command 函数，给一些命令增加相应的处理函数。在Vivi 启动后，可以进去操作界面，这些命令，就是供用户使用的。</P>
<P>(8) 启动内核或操作界面，需要用到boot_or_vivi()&nbsp;函数，此函数根据情况，直接启动Linux 内核，或者启动“vivi_shell"，进入与用户进行交互的界面。此时vivi 的引导任务完成。</P>
<P>&nbsp;&nbsp; </P></div>
        
        <div>
		</div>
		
        <div>
		</div>
		
		<div>
		</div>
		
        <div class="ptc phide ztag">
          <span class="ptcp">
            <span class="iblock bcmimg">&nbsp;</span>
            <span class="nbc-0 nbc-0-40 ptcmt ptcmt-2">评论这张</span>
          </span>
        </div>
		<div class="ptc phide ztag">
          <span class="ptcp">
            <span class="nbc-0 nbc-0-40 ptcmi">
              <img src="http://b.bst.126.net/newpage/images/microblog.png?1" />
            </span>
            <span class="nbc-0 nbc-0-40 ptcmt">转发至微博</span>
          </span>
        </div>
        
        
        <div class="nbw-act tbar fc03 clearfix">
          <div class="pleft rdif">
	          <span class="pnt pleft" id="$_spanRecommend"><img class="pclass" src="http://b.bst.126.net/style/common/tuijian.png"/></span>
	        <span id="$_spanShowRecommend" class="pleft rdct  phide">
	          <span class="pleft ul fc03"><span id="$_spanRecommendCount">0</span>人</span><span class="pleft iblock icn0 icn0-722 nbw-tgl1 nas-icn0fix">&nbsp;</span><span class="pleft iblock icn0 icn0-621 nbw-tgl0 nas-icn0fix">&nbsp;</span><span class="fc07"></span>|&nbsp;
	        </span>
	         <span class="fc07 pleft nas-tofix">分享到：</span><span class="nas-wrap pleft"><span id="$_shareBtn_163weibo" title="分享到网易微博" class="nas-itm nas-itm0">&nbsp;</span><span id="$_shareBtn_sinaweibo" title="分享到新浪微博" class="nas-itm nas-itm6">&nbsp;</span><span class="nas-itm nas-itm7" title="分享到MSN" id="$_shareBtn_msn">&nbsp;</span><span class="nas-itm nas-itm3" title="分享到QQ空间" id="$_shareBtn_qq">&nbsp;</span><span class="nas-itm nas-itm1" title="分享到人人网" id="$_shareBtn_renren">&nbsp;</span><span class="nas-itm nas-itm2" title="分享到开心网" id="$_shareBtn_kaixin">&nbsp;</span><span class="nas-itm nas-itm4" title="分享到豆瓣" id="$_shareBtn_douban">&nbsp;</span><span class="nas-itm nas-itm8" title="分享到梦幻人生" id="$_shareBtn_dream">&nbsp;</span></span></span>
          </div>
          <div class="pright">
              <span class="fc07">阅读(<span id="$_spaniReadCount">55</span>)</span><span class="sep fc07">|</span>
              <span class="fc07">评论(<span id="$_spaniCommentCount">0</span>)</span><span class="sep fc07">|</span>
              <span class="m2a" id="$_spanCite">引用</span> <span class="m2a" id="$_spanCiteCount">(0)</span>
              <span class="sep fc07">|</span><span id="$_spanReport" class="m2a">举报</span>
          </div>
        </div>
      </div>
      <div class="snl">
        <div class="phide bdwb bds2 bdc0 rdcnt" id="$_divRecommendContent"></div>
        <div id="yodaoad" class="bdwb bds2 bdc0" style="display:none;_zoom:1;">&nbsp;</div>
        <div id="$_divTopLink" class='top fc03 clearfix'>
	        <span class="ilft iblock icn0 icn0-620">&nbsp;</span>
	        <div class="pleft thide"><a class="m2a"  href="http://vicyliu1984.blog.163.com/blog/static/31541232201010345730363/">vivi 的目录结构</a></div>
	        <span class="irgt iblock icn0 icn0-619">&nbsp;</span>
	        <div class="pright thide"><a class="m2a"  href="http://vicyliu1984.blog.163.com/blog/static/315412322010103101313157/">U-Boot 的移植</a></div>
	     </div> 
	    <div class="relateblog phide">
          <h4 class="bdwb bds2 bdc0 fc07 fs0">历史上的今天</h4>
          <div class="cnt ztag clearfix"></div>
        </div>
	    <div class="relateblog phide">
          <h4 class="bdwb bds2 bdc0 fc07 fs0">相关文章</h4>
          <div class="cnt ztag clearfix"></div>
        </div>
	    <div class="author">
	      <h4 class="bdwb bds2 bdc0 fc07 fs0">最近读者</h4>
	      <div class="cnt ztag clearfix"></div>
	    </div>
	    <div class="phide" id="yodaoad_1" style="_zoom:1;"></div>
	    <div class="comment">
	      <h4 class="bdwb bds2 bdc0 fc07 fs0">评论</h4>
	      <a name="blogComment" id="blogComment"></a>
	      <div class="ztag"></div>
	    </div>
      </div>
      <div class="cite ztag fc03"></div>
    </div>
   </div>
  </div>
</div>
<div class="phide nb-init">
  <textarea name="js">
    this.p={  m:2,
              b:2,
              id:'fks_081074092084085065087085083095087087084071085084085065',
              blogTitle:'vivi 启动过程',
              blogAbstract:'<P\><STRONG\><FONT size=3\>1. vivi 启动的第一阶段</FONT\></STRONG\></P\>\r\n<P\>&nbsp;&nbsp;&nbsp; 第一阶段完成含依赖于 CPU 的体系结构硬件初始化的代码，包括禁止中断、初始化串口、复制自身到RAM 等。相关代码集中在head.S （arch\\your-arch\\目录下)。第一阶段中按先后顺序完成下面8项任务：</P\>\r\n<P\>(1)&nbsp;关闭watch dog。因为上电之后watch dog 默认是打开的。实现的代码如下：</P\>\r\n<P\>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;@ disable watch dog timer&nbsp; ；禁止看门狗计时器<BR\>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r1, #0x53000000</P\>',
              blogUrl:'blog/static/315412322010103538390',
              isPublished:1,
              istop:false,
              type:0,
              modifyTime:1288787512516,
              publishTime:1288787512492,
              permalink:'blog/static/315412322010103538390',
              commentCount:0,
              mainCommentCount:0,
              recommendCount:0,
              bsrk:-100,
              publisherId:0,
              recomBlogHome:false,
              attachmentsFileIds:[],
              vote:{},
              friendstatus:'none',
              followstatus:'unFollow',
              pubSucc:'',
              visitorProvince:'北京',
              visitorCity:'未设置',
              isWeekend:true,
              taobaoVersion:6,
              taobaolink:"http://g.163.com/a?CID=4399&Values=3931351846&Redirect=http://ju.atpanel.com/?url=http://www.tmall.com/?ad_id=100040497852881d4a61&am_id=&cm_id=&pm_id=",
              taobaobgimage:"http://blog.163.com/newpage/images/taobaolayerbg5.jpg",
              mset:'000',
              mcon:'',
              srk:-100,
              remindgoodnightblog:false,
              isBlackVisitor:false,
              isShowYodaoAd:false
            }
  </textarea>
  <textarea name="jst" id="m-3-jst-1">
    {list a as x}
    {if !!x}
    <div class="iblock nbw-fce nbw-f40">
      <a class="fc03 noul" target="_blank" hidefocus="true" href="http://blog.163.com/${x.visitorName}/">
      <img alt="${x.visitorNickname|escape}" onerror="location.f40" class="cwd bdwa bdc0" src="${fn1(x.visitorName)}"/>
      </a>
      <div class="cwd vname thide">
        {if x.moveFrom=='wap'}
          <a class="noul pnt" target="_blank" href="http://blog.163.com/services/wapblog.html?frompersonalbloghome"><span title="通过手机博客访问" class="iblock icn0 icn0-417">&nbsp;</span></a>
        {/if}
        <a class="fc03 m2a"  target="_blank" hidefocus="true" href="http://blog.163.com/${x.visitorName}/">
          ${fn(x.visitorNickname,8)|escape}
        </a>
      </div>
    </div>
    {/if}
    {/list}
  </textarea>
  <textarea name="jst" id="m-3-jst-2">
    {if !!a}
    <a target="_blank" href="http://blog.163.com/${a.userName}/"><img class="bdwa bdc0 pnt" onerror="location.f60" src="${fn1(a.userName)}"/></a>
    <a target="_blank" class="fc03 m2a" href="http://blog.163.com/${a.userName}/">${fn(a.nickname,8)|escape}</a>
    <div class="intro fc05">${a.selfIntro|escape}{if great260}${suplement}{/if}</div>
	    <div class="acts ztag"></div>
    {/if}
  </textarea>
  <#--最新日志，群博日志-->
  <textarea name="jst" id="m-3-jst-3">
    {list a as x}
    {if !!x}
    <li class="thide"><a target="_blank" class="fc03 m2a" href="${furl()}${x.permalink}/?latestBlog">${fn(x.title,26)|escape}</a></li>
    {/if}
    {/list}
  </textarea>
  <#--推荐日志-->
  <textarea name="jst" id="m-3-jst-4">
    <p class="fc06">推荐过这篇日志的人：</p>
    <div>
      {list a as x}
      {if !!x}
      <div class="iblock nbw-fce nbw-f40">
        <a class="fc03 noul" target="_blank" hidefocus="true" href="http://blog.163.com/${x.recommenderName}/">
        <img alt="${x.recommenderNickname}" onerror="location.f40" class="cwd bdwa bdc0" src="${fn1(x.recommenderName)}"/>
        </a>
        <div class="cwd thide">
          <a class="fc03 m2a" target="_blank" hidefocus="true" href="http://blog.163.com/${x.recommenderName}/">
            ${fn(x.recommenderNickname,6)|escape}
          </a>
        </div>
      </div>
      {/if}
      {/list}
    </div>
    {if !!b&&b.length>0}
    <p  class="fc06">他们还推荐了：</p>
    <ul>
    {list b as y}
      {if !!y}
        <li class="rrb"><span class="iblock">&#183;</span><a class="fc03 m2a" target="_blank" href="http://blog.163.com/${y.recommendBlogPermalink}/?from=blog/static/315412322010103538390">${y.recommendBlogTitle}</a></li>
      {/if}
    {/list}
    </ul>
    {/if}
  </textarea>
  <#--引用记录-->
  <textarea name="jst" id="m-3-jst-5">
    <span class="pleft fc07">引用记录：</span>
    <ul class="tbac">
    {list d as x}
      <li class="clearfix">
        <span class="pleft iblock">&#183;</span>
        <div class="tbl thide pleft"><span><a target="_blank" class="fc07 m2a" href="${x.referBlogUrl}">${x.referBlogTitle}</a></span></div>
        <div class="tbr pleft"><span><a target="_blank" class="fc07 m2a" href="${x.referHomePage}">${x.referUserName}</a></span></div>
      </li>
    {/list}
    </ul>
  </textarea>
  <#--博主推荐-->
  <textarea name="jst" id="m-3-jst-6">
    {list a as x}
    {if !!x}
    <li class="thide"><a target="_blank" class="fc03 m2a" href="http://blog.163.com/${x.userName}/${x.permalink}/?recommendBlog" title="${x.title|default:""|escape}">${x.title|default:""|escape}</a></li>
    {/if}
    {/list}
  </textarea>
  <#--随机阅读-->
  <textarea name="jst" id="m-3-jst-7">
    {list a as x}
    {if !!x}
    <li class="thide"><a target="_blank" class="fc03 m2a" href="http://blog.163.com/${x.userName}/${x.permalink}/?personalRecomBlog" title="${x.title|default:""|escape}">${x.title|default:""|escape}</a></li>
    {/if}
    {/list}
  </textarea>
  <#--首页推荐-->
  <textarea name="jst" id="m-3-jst-8">
    {list a as x}
    {if !!x}
    <li class="thide"><a target="_blank" class="fc03 m2a" target="_blank" href="${x.blogUrl|default:""|escape}?recommendReader" title="${x.blogTile|default:""|escape}">${x.blogTile|default:""|escape}</a></li>
    {/if}
    {/list}
  </textarea>
  <#--相关文章-->
  <textarea name="jst" id="m-3-jst-9">
    <ul>
      {list a as x}
      {if x_index>9}{break}{/if}
      {if !!x}
        <li class="thide fc03">
          <a class="m2a" target="_blank" target="_blank"  href="${x.url|default:""}?fromdm&fromSearch&isFromSearchEngine=${isFromSearchEngine|default:"no"}"  title="${x.title|default:""|escape}">${x.title|default:""|escape}</a><span class="fc07">${fn2(parseInt(x.date),'yyyy-MM-dd HH:mm:ss')}</span>
        </li>
      {/if}
      {/list}
    </ul>
  </textarea>
  <#--历史上的今天-->
  <textarea name="jst" id="m-3-jst-10">
    <ul>
      {list a as x}
      {if x_index>4}{break}{/if}
      {if !!x}
        <li class="thide fc03">
          <a class="m2a" target="_blank"  href="http://blog.163.com/${x.userName}/${x.permalink|default:""}"  title="${x.title|default:""|escape}">${fn1(x.title,60)|escape}</a><span class="fc07">${fn2(x.publishTime,'yyyy-MM-dd HH:mm:ss')}</span>
        </li>
      {/if}
      {/list}
    </ul>
  </textarea>
  <#--右边模块结构-->
  <textarea name="txt" id="m-3-txt-0">
    <div class="uinfo ztag"></div>
    <h4 class="fc07 fs0 ltt">最新日志</h4>
    <ul class="ztag blst"></ul>
    <h4 class="fc07 fs0 ltt phide ztag">该作者的其他文章</h4>
    <ul class="ztag blst"></ul>
    <h4 class="fc07 fs0 ltt phide ztag">博主推荐</h4>
    <ul class="ztag blst"></ul>
    <h4 class="fc07 fs0 ltt phide ztag">相关日志</h4>
    <ul class="ztag blst"></ul>
    <h4 class="fc07 fs0 ltt phide ztag">随机阅读</h4>
    <ul class="ztag blst"></ul>
    <h4 class="fc07 fs0 ltt phide ztag">首页推荐</h4>
    <ul class="ztag blst"></ul>
    <div class="more"><a target="_blank" class="fc03 m2a" href="http://blog.163.com">更多&gt;&gt;</a></div>
    <a id="yodaoad_suggest" target="_blank" href="http://fankui.163.com/ft/comment.fb?pid=5002&fid=15001" class="fc05 m2a phide">对“推广广告”提建议</a>
    <br/><br/>
    <div id="yodaoad_r" style="display:none;_zoom:1;"></div>
  </textarea>
  <#--评论模块结构-->
  <textarea name="txt" id="m-3-txt-1">
    <div class="publish ztag"></div>
    <div class="bdwt bds2 bdc0 phide" id="yodaoad_2" style="_zoom:1;"></div>
    <div class="ztag bdwt bds2 bdc0">
      <div class="case"></div>
      <div class="clearfix"></div>
    </div>
  </textarea>
  <#--引用模块结构-->
  <textarea name="jst" id="m-3-txt-2">
     <div class="close">
       <span class="ztag iblock icn0 icn0-57">&nbsp;</span>
     </div>
	 <div class="ztag phide"></div>
  </textarea>
    <#--博主发起的投票-->
  <textarea name="jst" id="m-3-txt-3">
    {list a as x}
    {if !!x}
      <li>
      <a href="http://blog.163.com/${x.userName}/" target="_blank" class="m2a fc03">${x.nickName|escape}</a>&nbsp;&nbsp;投票给
        {var first_option = true;}
        {list x.voteDetailList as voteToOption}
            {if voteToOption==1}
              {if first_option==false},{/if}&nbsp;&nbsp;“${b[voteToOption_index]}”&nbsp;&nbsp;
            {/if}
        {/list}
        {if (x.role!="-1") },“我是${c[x.role]}”&nbsp;&nbsp;{/if}
        &nbsp;&nbsp;&nbsp;&nbsp;<span class="fc07">&nbsp;&nbsp;&nbsp;&nbsp;${fn1(x.voteTime)}</span>
        {if x.userName==''}{/if}
    {/if}
    {/list}
  </textarea>
</div>
</div>
      <div class="l cl h100">&nbsp;</div>
      <div class="r cr h100">&nbsp;</div>
    </div>
    <div class="nb-mb lcr bh space">
      <div class="l bl bh">&nbsp;</div>
      <div class="r br bh">&nbsp;</div>
      <div class="c bc bh lcr">&nbsp;</div>
    </div>
  </div>
</div>
      <div class="l wl g lg h100">&nbsp;</div>
      <div class="l wl t lt">&nbsp;</div>
      <div class="l wl b lb">&nbsp;</div>
      <div class="r wr g rg h100">&nbsp;</div>
      <div class="r wr t rt">&nbsp;</div>
      <div class="r wr b rb">&nbsp;</div>
    </div>
  </div>
  <div class="nb-are nb-smb"><div class="wkg h space"><div class="l h">&nbsp;</div><div class="r h">&nbsp;</div><div class="c h">&nbsp;</div></div></div>
<div class="nb-are nb-fot">
  <div class="wkg h">
    <h2>页脚</h2>
    <div class="k">
      <a class="m2a fc08" target="_blank" href="http://corp.163.com/index_gb.html">公司简介</a>
      <span class="p fc10">-</span>
      <a class="m2a fc08" target="_blank" href="http://gb.corp.163.com/gb/contactus.html">联系方法</a>
      <span class="p fc10">-</span>
      <a class="m2a fc08" target="_blank" href="http://corp.163.com/gb/job/job.html">招聘信息</a>
      <span class="p fc10">-</span>
      <a class="m2a fc08" target="_blank" href="http://help.163.com/?b13abk1">客户服务</a>
      <span class="p fc10">-</span>
      <a class="m2a fc08" target="_blank" href="http://corp.163.com/gb/legal/legal.html">相关法律</a>
      <span class="p fc10">-</span>
      <a class="m2a fc08" target="_blank" href="http://blog.163.com/public/theme/">博客风格</a>
      <span class="p fc10">-</span>
      <a class="m2a fc08" target="_blank" href="http://blog.163.com/services/wapblog.html">手机博客</a>
      
      <link rel="alternate" type="application/rss+xml" title="RSS" href="http://vicyliu1984.blog.163.com/rss/"/>
      <span class="p fc10">-</span><span class="fc08" id="$_foot_subscribe"><span class="iblock m2a icn0 icn0-919">&nbsp;</span><a class="m2a fc08">订阅此博客</a></span>
    </div>
    <p class="fc08">网易公司版权所有&nbsp;&copy;1997-2011</p>
  </div>
</div></div>
    <!--[if lte IE 6]></div><![endif]-->
  <!--[if lte IE 6]></div><![endif]-->
  <div class="nb-layer" id="blog-163-com-layer"></div>
  <div class="nb-tpl nb-init phide" id="blog-163-com-template" style="display:none;">  <textarea rows="1" cols="1" name="jst" id="nb-jst-a1">  <a class="pr" target="_blank" href="http://help.163.com/special/007525FT/blog.html?b13aze1">帮助</a>
  <span class="fr iblock space icn1 icn1-4">&nbsp;</span>
  <a class="pr" target="_blank" href="http://blog.163.com/activation.do?host=activation&&username=${u}">${u}</a>
</textarea>
  <textarea rows="1" cols="1" name="jst" id="nb-jst-d0">      {list wl as x}
        <div class="grp">${x.g}</div>
        {list x.l as y}
        <a class="itm noul" href="#" hidefocus="true" name="{if typeof(y.v)=='string'}${y.v}{else}${y_index}{/if}">${y.n}</a>
        {/list}
      {/list}
</textarea>
  <textarea rows="1" cols="1" name="jst" id="nb-jst-d1">	{if defined('wl')}
        {list wl as x}<a class="itm noul" href="#" hidefocus="true" name="${x.v}">${x.n}</a>{/list}
    {/if}
</textarea>
</div>
<script type="text/javascript">
  window.N = {tm:{'zbtn':'nbtn',
                  'bdc0':'bdc0','bdc2':'bdc1',
				  'bgc0':'bgc0','bgc1':'bgc1','bgc2':'bgc2','bgh0':'bgc9',
				  'fc00':'fc03','fc01':'fc04','fc02':'fc05','fc03':'fc06','fc04':'fc07','fc05':'fc09'}};
  Date.servTime = '04/07/2011 15:21:36';
  location.api = 'http://api.blog.163.com/';
  location.msg = 'http://api.blog.163.com/msg/dwr';
  location.dwr = 'http://api.blog.163.com/vicyliu1984/dwr';
  location.vcd = 'http://api.blog.163.com/cap/captcha.jpgx?parentId=31541232&r=';
  location.mrt = 'http://b.bst.126.net/newpage/style/mbox/';
  location.fce = 'http://os.blog.163.com/common/ava.s?host=';
  location.fce2= 'http://os.blog.163.com/common/ava.s?host=';
  location.passportfce = 'http://os.blog.163.com/common/ava.s?passport=';
  location.fpr = 'http://b.bst.126.net/common/portrait/face/preview/';
  location.f60 = 'http://b.bst.126.net/common/face60.png';
  location.f140= 'http://b.bst.126.net/common/face140.png';
  location.adf140= 'http://b.bst.126.net/common/admireface140.png';
  location.ept = 'http://b.bst.126.net/common/empty.png';
  location.guide_profile_add= 'http://b.bst.126.net/common/guide_profile_add.gif';
  location.phtoto_dream = 'http://photo.dream.163.com/blog/writeBlogCallback.do';
  window.CF = {
    ca:false
   ,cb:''
   ,cc:false
   ,cd:false
   ,ce:'-3'
   ,ck:0
   ,ci:['api.blog.163.com'
       ,'http://photo.163.com/photo/html/crossdomain.html?t=20100205'
        
        ,'ud.blog.163.com'
        
        
        
        
        ]
   ,cj:[-3]
   ,cl:''
   ,cm:["","blog/","album/","music/","collection/","friends/","profile/","pprank/"]
   ,cf:0
   ,co:{pv:false
       ,ti:4034
       ,tn:''
       ,tc:0
       ,tl:3
       ,ut:0
       ,un:''
       ,um:''
       ,ui:0
       ,ud:false}
   ,cp:{nr:0
       ,cr:0
       ,vr:-100
       ,fr:0}
   ,cs:0
   ,ct:{'nav':['首页','日志','相册','音乐','收藏','博友','关于我'],'enabled':[0,1,6],'defaultnav':parseInt('1111111',2)}
   ,cu:false
   ,cv:false
   ,cw:false
  };
  window.UD = {};
  UD.host = {
      userId:31541232
     ,userName:'vicyliu1984'
     ,nickName:'vicyliu1984'
     ,baseUrl:'http://vicyliu1984.blog.163.com/'
     ,gender:'他'
     ,email:'vicyliu1984@163.com'
     ,photo163Name:'vicyliu1984'
     ,photo163HostName:'vicyliu1984'
     ,TOKEN_HTMLMODULE:''
     ,isMultiUserBlog:false
  };
</script>
    <script type="text/javascript" src="http://b1.bst.126.net/newpage/r/j/pc.js?v=4055614633"></script>
 <script type="text/javascript" src="http://music.ph.126.net/ph.js?001"></script>
    <script type="text/javascript" src="http://b1.bst.126.net/newpage/r/j/m/m-3/pm.js?v=2288658740"></script>
  <script src="http://analytics.163.com/ntes.js" type="text/javascript"></script>
  <script type="text/javascript">
    _ntes_nacc='blog';neteaseTracker();
    
    new Image().src = 'http://blog.163.com/newpage/images/analyse.png?s=p&t='+new Date().getTime();
  </script>
</body>
</html>
