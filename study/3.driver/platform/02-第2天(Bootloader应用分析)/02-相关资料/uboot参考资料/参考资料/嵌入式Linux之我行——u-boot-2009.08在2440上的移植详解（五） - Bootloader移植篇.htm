
<!-- saved from url=(0058)http://blog.chinaunix.net/u3/101649/showart.php?id=2134240 -->
<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=GBK">

<LINK rel="stylesheet" href="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/index.css">
<LINK rel="alternate" type="application/rss+xml" title="ChinaUnix Blog RSS Feed" href="http://blog.chinaunix.net/u/rss.php?id=101649">
<META name="keywords" content="嵌入式Linux之我行&mdash;&mdash;u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇 - hbhuanggang">
<META name="description" content="中国最大的IT技术博客-ChinaUnix博客：嵌入式Linux之我行&mdash;&mdash;u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇 - hbhuanggang">
<TITLE>嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇 - hbhuanggang</TITLE>
</HEAD><BODY leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" style="background:#FFFFFF;background-image:url()" align="center">


<TABLE border="0" cellspacing="0" cellpadding="0" background="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/tophem1.gif" style="border-collapse: collapse;height:25" height="25" width="100%">
<TBODY><TR> <TD id="tool-bar" align="left" width="540" nowrap="">
&nbsp;
<A href="http://blog.chinaunix.net/" target="_blank">博客首页</A>
<A href="http://blog.chinaunix.net/register.php" target="_blank">注册</A>
<A href="http://bbs.chinaunix.net/forumdisplay.php?fid=51" target="_blank">建议与交流</A> 
<A href="http://blog.chinaunix.net/top/" target="_blank">排行榜</A>
<A href="" target="_blank" onclick="NewWindows(&#39;http://www.cublog.cn/addlink.php?url=&#39;+location.href+&#39;&amp;title=&#39;+document.title);return false;">加入友情链接</A>

</TD><FORM id="loginForm" method="get" target="_blank" action="http://blog.chinaunix.net/search.php"></FORM>
<TD align="right" nowrap="">
<IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/userstar.php" id="starimg" border="0" alt="" width="55" height="12">
<A href="http://blog.chinaunix.net/u2/star.php?blogid=101649" id="star" onclick="NewWindows(this.href);return false;" title="给此博客推荐值">推荐</A>
<A href="http://blog.chinaunix.net/u2/complaint.php?blogid=101649" id="complaint" onclick="NewWindows(this.href);return false;" title="投诉此博客">投诉</A>

 搜索：<INPUT type="text" name="q" size="20"> <INPUT type="submit" value="搜索" class="button1"> <A href="http://blog.chinaunix.net/help/">帮助</A></TD>
</TR>
<TR><TD colspan="2">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111" width="1000">
<TBODY><TR><TD width="1000"></TR>
</TBODY></TABLE>
</TD></TR>
</TBODY></TABLE>
<SCRIPT language="javascript">
<!--

navHover = function() {
var lis = document.getElementById("navmenu").getElementsByTagName("LI");
for (var i=0; i<lis.length; i++) {
lis[i].onmouseover=function() {
this.className+=" iehover";
}
lis[i].onmouseout=function() {
this.className=this.className.replace(new RegExp(" iehover\\b"), "");
}
}
}

function NewWindows(shref){
var xx=(window.screen.width-450)/2;
var yy=(window.screen.height-200)/2;
pp=window.open(shref,"win","menubar=no,location=no,resizable=no,scrollbars=no,status=no,left="+xx+",top="+yy+",Width=450,Height=200");
}
function $(s){return document.getElementById(s);}
//-->
</SCRIPT>
<TABLE border="0" cellspacing="0" cellpadding="0" height="80" style="border-collapse: collapse;background-image:url();background-repeat: " width="100%" bgcolor="#204689">
<TBODY><TR><TD align="center" width="200">
<P style="line-height: 150%; margin: 5px">
 <FONT style="font-size:14px" color="#FFFFFF">
 
<B>
 
 
 
 hbhuanggang 
 
 
</B>
 
 </FONT></P>
 
</TD><TD style="color:#AAC6F6">
</TD></TR>
</TBODY></TABLE>

<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="100%" height="27" bgcolor="#EEEEEE">
<TBODY><TR><TD>&nbsp;
<A href="http://hbhuanggang.cublog.cn/" class="list1" target="_blank">hbhuanggang.cublog.cn</A>
 
</TD><TD align="right" style="color:#2A5200" width="680">
<UL id="navmenu"><LI class="ul0"><A href="http://control.cublog.cn/" target="_blank" class="list1">管理博客</A> </LI>

<LI class="ul0"><A href="http://control.cublog.cn/article_new.php" target="_blank" class="list1">发表文章</A></LI>
<LI class="ul0"><A href="http://blog.chinaunix.net/u3/101649/guestbook.html" class="list1">留言</A></LI>
<LI class="ul0"><A href="http://blog.chinaunix.net/u3/101649/links.html" class="list1">收藏夹</A>
<UL class="ul1"><LI><A href="http://blog.chinaunix.net/u3/101649/links_20167.html"> ・ C程序设计<!-- a20167 --></A><!-- 20167 --></LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/links_20335.html"> ・ ARM Linux开发<!-- a20335 --></A><!-- 20335 --></LI>
</UL>

</LI>
<LI class="ul0"><A href="http://blog.chinaunix.net/u3/101649/group.html" class="list1">博客圈</A></LI>
<LI class="ul0"><A href="http://blog.chinaunix.net/u3/101649/music.html" class="list1">音乐</A>
<!-- 0 -->
</LI>
<LI class="ul0"><A href="http://blog.chinaunix.net/u3/101649/photo.html" class="list1">相册</A>
<UL class="ul1"><LI><A href="http://blog.chinaunix.net/u3/101649/photo_16460.html"> ・ 嵌入式Linux+ARM&nbsp;&nbsp;&nbsp;<FONT face="Wingdings 3">}</FONT></A><UL class="ul2"><LI><A href="http://blog.chinaunix.net/u3/101649/photo_16461.html"> ・ 系统、应用移植&nbsp;&nbsp;&nbsp;<FONT face="Wingdings 3">}</FONT></A><UL class="ul2"><LI><A href="http://blog.chinaunix.net/u3/101649/photo_16472.html"> ・ 虚拟机中安装Linux<!-- a16472 --></A><!-- 16472 --></LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/photo_16512.html"> ・ 虚拟机中实现Linux与Windows之间的文件传输<!-- a16512 --></A><!-- 16512 --></LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/photo_16525.html"> ・ 开发环境的建立与Eclipse的使用<!-- a16525 --></A><!-- 16525 --></LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/photo_16532.html"> ・ 嵌入式数据库sqlite在2440上的移植<!-- a16532 --></A><!-- 16532 --></LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/photo_16950.html"> ・ Linux-2.6.30.4在2440上的移植<!-- a16950 --></A><!-- 16950 --></LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/photo_17160.html"> ・ U-Boot在2440上的移植<!-- a17160 --></A><!-- 17160 --></LI>
</UL>
</LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/photo_16488.html"> ・ WEB应用&nbsp;&nbsp;&nbsp;<FONT face="Wingdings 3">}</FONT></A><UL class="ul2"><LI><A href="http://blog.chinaunix.net/u3/101649/photo_16489.html"> ・ C+CGI+Ajax在S3C2440中的应用<!-- a16489 --></A><!-- 16489 --></LI>
</UL>
</LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/photo_17103.html"> ・ 内核、驱动开发<!-- a17103 --></A><!-- 17103 --></LI>
</UL>
</LI>
</UL>

</LI> 
 
<LI class="ul0"><A href="http://blog.chinaunix.net/u3/101649/article.html" class="list1">文章</A>
<UL class="ul1"><LI><A href="http://blog.chinaunix.net/u3/101649/article_117632.html"> ・ 嵌入式Linux+ARM&nbsp;&nbsp;&nbsp;<FONT face="Wingdings 3">}</FONT></A><UL class="ul2"><LI><A href="http://blog.chinaunix.net/u3/101649/article_140698.html"> ・ 基础篇<!-- a140698 --></A><!-- 140698 --></LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/article_140792.html"> ・ 内核、文件系统、应用移植开发篇<!-- a140792 --></A><!-- 140792 --></LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/article_140793.html"> ・ Bootloader移植篇<!-- a140793 --></A><!-- 140793 --></LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/article_117641.html"> ・ 内核、驱动开发篇<!-- a117641 --></A><!-- 117641 --></LI>
<LI><A href="http://blog.chinaunix.net/u3/101649/article_140795.html"> ・ 其他电子通讯技术篇<!-- a140795 --></A><!-- 140795 --></LI>
</UL>
</LI>
</UL>

</LI> 
<LI class="ul0"><A href="http://blog.chinaunix.net/u3/101649/index.html" class="list1">首页</A></LI>
</UL>
</TD>
<TD width="2">
</TR>
</TBODY></TABLE>
<SCRIPT language="javascript">
function $(s){return document.getElementById(s);}
function ShowHideDiv(divid,iImg){
if($(divid).style.display == "none"){
iImg.src="../../templates/tech/images/dot2.gif";
$(divid).style.display = "block";
iImg.title="收起";
}else{
iImg.src="../../templates/tech/images/dot4.gif";
$(divid).style.display = "none";
iImg.title="展开";
}
}
if (window.attachEvent) window.attachEvent("onload", navHover);
</SCRIPT>

<SCRIPT language="javascript" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/pv.js"></SCRIPT><DIV style="display:none"><IMG id="pv_img" width="1" height="1" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/count.ashx"></DIV>
<SCRIPT>
function sendPV(){
    var pvTrack = new PvTrack();
    pvTrack.type = 10; // 频道类别ID
    pvTrack.channel = 189; // 频道ID
   
    pvTrack.pageType = 0;
    pvTrack.track();
}
window.setTimeout("sendPV()", 0);
</SCRIPT>
<SCRIPT language="javascript" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/pv(1).js" type="text/javascript"></SCRIPT><SCRIPT language="javascript" type="text/javascript" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/pvpv.js"></SCRIPT><SCRIPT src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ga.js" type="text/javascript"></SCRIPT><SCRIPT language="javascript" type="text/javascript" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/g.js"></SCRIPT><SCRIPT src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ga.js" type="text/javascript"></SCRIPT>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="100%">
<TBODY><TR><TD width="235" valign="top" align="center">
<BR>

<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111" width="220">
<TBODY><TR><TD><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/left_bg_top.gif" border="0" alt=""></TD></TR>
<TR><TD bgcolor="#EDF2F2" height="25" align="center">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111" width="200">
<TBODY><TR><TD width="180" align="center"><FONT style="font-size:10pt" color="#1F72D0"><B>关于作者</B></FONT></TD><TD width="20"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/dot2.gif" border="0" title="收起" onclick="ShowHideDiv(&#39;aboutwriter&#39;,this);return false;"></TD></TR>
</TBODY></TABLE>

</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1"></TR>
<TR><TD bgcolor="#FFFFFF" height="1"></TR>

<TR><TD style="color:#02368D" bgcolor="F3F6F6" align="center">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;table-layout: fixed;color:#02368D;" width="200" id="aboutwriter">
<TBODY><TR><TD align="center">
<A href="http://blog.chinaunix.net/u3/101649/up_user.png" target="_blank"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/up_user_pre.jpg" border="0" alt=""></A>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;" width="200">
<TBODY><TR><TD width="200">
<PRE style="line-height: 150%; margin: 5px; " width="25">姓名：黄刚
职业：嵌入式Linux
位置：深圳
</PRE>	
</TD></TR>
</TBODY></TABLE>
</TD></TR>
</TBODY></TABLE>
</TD></TR>
<TR><TD>
<TABLE bgcolor="#FFFFFF" cellspacing="0" cellpadding="0" style="border-collapse: collapse;border: 1px solid #D2DEE2; padding: 1" align="center" width="220" border="0">
<TBODY><TR height="20" bgcolor="#EDF2F2">
<TD align="center" width="14" style="cursor: hand; color: #1F72D0;font-size:9pt;" title="上一年" onclick="pushBtm(&#39;YU&#39;)">||</TD>
<TD align="center" width="14" style="cursor: hand; color: #1F72D0;font-size:9pt" title="上一月" onclick="pushBtm(&#39;MU&#39;)">&lt;&lt;</TD>
<TD align="center" nowrap="nowrap" id="YMBG" style="color: #1F72D0;font-size:9pt">2010年9月</TD>
<TD align="center" nowrap="nowrap" id="GZ" style="color: #1F72D0;font-size:9pt">庚寅年（虎）</TD>
<TD align="center" width="14" style="cursor: hand; color: #1F72D0;font-size:9pt" title="下一月" onclick="pushBtm(&#39;MD&#39;)">&gt;&gt;</TD>
<TD align="center" width="14" style="cursor: hand; color: #1F72D0;font-size:9pt" title="下一年" onclick="pushBtm(&#39;YD&#39;)">||</TD>
</TR>
<TR><TD colspan="6">
<DIV id="ttdiv" align="center" width="210"><TABLE cellspacing="0" cellpadding="0" width="216" style="border-collapse: collapse" bgcolor="#F6F8F8" border="0" id="datetable">
	  <TBODY><TR align="center" bgcolor="#EDF2F2" style="color:#A6AA97">
		<TD width="32" height="24">日</TD>
		<TD width="32">一</TD>
		<TD width="32">二</TD>
		<TD width="32">三</TD>
		<TD width="32">四</TD>
		<TD width="32">五</TD>
		<TD width="32">六</TD></TR>
	  <TR align="center">
	  <TD nowrap="nowrap">
<FONT id="SD0" size="2" face="Arial Black" color="#CDBC71" title="" class=""></FONT><BR><FONT id="LD0" style="font-size:7pt"></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD1" size="2" face="Arial Black" color="#A6AA97" title="" class=""></FONT><BR><FONT id="LD1" style="font-size:7pt"></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD2" size="2" face="Arial Black" color="#A6AA97" title="" class=""></FONT><BR><FONT id="LD2" style="font-size:7pt"></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD3" size="2" face="Arial Black" color="#A6AA97" title="廿三" class="">1</FONT><BR><FONT id="LD3" style="font-size:7pt">廿三</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD4" size="2" face="Arial Black" color="#A6AA97" title="廿四" class="">2</FONT><BR><FONT id="LD4" style="font-size:7pt">廿四</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD5" size="2" face="Arial Black" color="#A6AA97" title="廿五" class="">3</FONT><BR><FONT id="LD5" style="font-size:7pt">廿五</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD6" size="2" face="Arial Black" color="#CDBC71" title="廿六" class="">4</FONT><BR><FONT id="LD6" style="font-size:7pt">廿六</FONT></TD>	  </TR>
	  <TR align="center">
	  <TD nowrap="nowrap">
<FONT id="SD7" size="2" face="Arial Black" color="#CDBC71" title="廿七" class="" style="color: rgb(205, 188, 113); ">5</FONT><BR><FONT id="LD7" style="font-size:7pt">廿七</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD8" size="2" face="Arial Black" color="#A6AA97" title="廿八" class="">6</FONT><BR><FONT id="LD8" style="font-size:7pt">廿八</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD9" size="2" face="Arial Black" color="#A6AA97" title="廿九" class="">7</FONT><BR><FONT id="LD9" style="font-size:7pt">廿九</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD10" size="2" face="Arial Black" color="#A6AA97" title="白露" class="">8</FONT><BR><FONT id="LD10" style="font-size:7pt"><FONT color="limegreen">白露</FONT></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD11" size="2" face="Arial Black" color="#A6AA97" title="初二" class="">9</FONT><BR><FONT id="LD11" style="font-size:7pt">初二</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD12" size="2" face="Arial Black" color="#A6AA97" title="教师节 " class="">10</FONT><BR><FONT id="LD12" style="font-size:7pt"><FONT color="#6FC2FF">教师节 </FONT></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD13" size="2" face="Arial Black" color="#CDBC71" title="初四" class="" style="color: rgb(205, 188, 113); ">11</FONT><BR><FONT id="LD13" style="font-size:7pt">初四</FONT></TD>	  </TR>
	  <TR align="center">
	  <TD nowrap="nowrap">
<FONT id="SD14" size="2" face="Arial Black" color="#CDBC71" title="初五" class="" style="color: rgb(205, 188, 113); ">12</FONT><BR><FONT id="LD14" style="font-size:7pt">初五</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD15" size="2" face="Arial Black" color="#A6AA97" title="初六" class="">13</FONT><BR><FONT id="LD15" style="font-size:7pt">初六</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD16" size="2" face="Arial Black" color="#A6AA97" title="初七" class="">14</FONT><BR><FONT id="LD16" style="font-size:7pt">初七</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD17" size="2" face="Arial Black" color="#A6AA97" title="初八" class="">15</FONT><BR><FONT id="LD17" style="font-size:7pt">初八</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD18" size="2" face="Arial Black" color="#A6AA97" title="初九" class="todyaColor">16</FONT><BR><FONT id="LD18" style="font-size:7pt">初九</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD19" size="2" face="Arial Black" color="#A6AA97" title="初十" class="">17</FONT><BR><FONT id="LD19" style="font-size:7pt">初十</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD20" size="2" face="Arial Black" color="#CDBC71" title="十一" class="">18</FONT><BR><FONT id="LD20" style="font-size:7pt">十一</FONT></TD>	  </TR>
	  <TR align="center">
	  <TD nowrap="nowrap">
<FONT id="SD21" size="2" face="Arial Black" color="#CDBC71" title="十二" class="" style="color: rgb(205, 188, 113); ">19</FONT><BR><FONT id="LD21" style="font-size:7pt">十二</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD22" size="2" face="Arial Black" color="#A6AA97" title="十三" class="">20</FONT><BR><FONT id="LD22" style="font-size:7pt">十三</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD23" size="2" face="Arial Black" color="#A6AA97" title="十四" class="">21</FONT><BR><FONT id="LD23" style="font-size:7pt">十四</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD24" size="2" face="Arial Black" color="#A6AA97" title="中秋节 " class="">22</FONT><BR><FONT id="LD24" style="font-size:7pt"><FONT color="#6FC2FF">中秋节 </FONT></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD25" size="2" face="Arial Black" color="#A6AA97" title="秋分" class="">23</FONT><BR><FONT id="LD25" style="font-size:7pt"><FONT color="limegreen">秋分</FONT></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD26" size="2" face="Arial Black" color="#A6AA97" title="十七" class="">24</FONT><BR><FONT id="LD26" style="font-size:7pt">十七</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD27" size="2" face="Arial Black" color="#CDBC71" title="十八" class="" style="color: rgb(205, 188, 113); ">25</FONT><BR><FONT id="LD27" style="font-size:7pt">十八</FONT></TD>	  </TR>
	  <TR align="center">
	  <TD nowrap="nowrap">
<FONT id="SD28" size="2" face="Arial Black" color="#CDBC71" title="十九" class="" style="color: rgb(205, 188, 113); ">26</FONT><BR><FONT id="LD28" style="font-size:7pt">十九</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD29" size="2" face="Arial Black" color="#A6AA97" title="二十" class="">27</FONT><BR><FONT id="LD29" style="font-size:7pt">二十</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD30" size="2" face="Arial Black" color="#A6AA97" title="廿一" class="">28</FONT><BR><FONT id="LD30" style="font-size:7pt">廿一</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD31" size="2" face="Arial Black" color="#A6AA97" title="廿二" class="">29</FONT><BR><FONT id="LD31" style="font-size:7pt">廿二</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD32" size="2" face="Arial Black" color="#A6AA97" title="廿三" class="">30</FONT><BR><FONT id="LD32" style="font-size:7pt">廿三</FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD33" size="2" face="Arial Black" color="#A6AA97" title="" class=""></FONT><BR><FONT id="LD33" style="font-size:7pt"></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD34" size="2" face="Arial Black" color="#CDBC71" title="" class=""></FONT><BR><FONT id="LD34" style="font-size:7pt"></FONT></TD>	  </TR>
	  <TR align="center">
	  <TD nowrap="nowrap">
<FONT id="SD35" size="2" face="Arial Black" color="#CDBC71" title="" class=""></FONT><BR><FONT id="LD35" style="font-size:7pt"></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD36" size="2" face="Arial Black" color="#A6AA97" title="" class=""></FONT><BR><FONT id="LD36" style="font-size:7pt"></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD37" size="2" face="Arial Black" color="#A6AA97" title="" class=""></FONT><BR><FONT id="LD37" style="font-size:7pt"></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD38" size="2" face="Arial Black" color="#A6AA97" title="" class=""></FONT><BR><FONT id="LD38" style="font-size:7pt"></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD39" size="2" face="Arial Black" color="#A6AA97" title="" class=""></FONT><BR><FONT id="LD39" style="font-size:7pt"></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD40" size="2" face="Arial Black" color="#A6AA97" title="" class=""></FONT><BR><FONT id="LD40" style="font-size:7pt"></FONT></TD>	  <TD nowrap="nowrap">
<FONT id="SD41" size="2" face="Arial Black" color="#CDBC71" title="" class=""></FONT><BR><FONT id="LD41" style="font-size:7pt"></FONT></TD>	  </TR>
</TBODY></TABLE></DIV>
</TD></TR>
<TR><TD colspan="6" height="1"></TR>
</TBODY></TABLE>

<SCRIPT src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/mdate.js"></SCRIPT>
<SCRIPT language="javascript">
var arrArtdate=new Array('20090723','20090729','20090801','20090802','20090805','20090818','20091020','20091022','20091023','20091026','20091027','20091028','20091103','20091105','20091106','20091111','20091118','20091123','20091126','20091204','20091211','20091213','20091221','20091229','20100109','20100113','20100121','20100222','20100301','20100406','20100505','20100520','20100604','20100613','20100712','20100720');

initial("ttdiv");

</SCRIPT>

</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1"></TR>
<TR><TD bgcolor="#FFFFFF" height="1"></TR>
<TR><TD bgcolor="#EDF2F2" height="25" align="center">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111" width="200">
<TBODY><TR><TD width="180" align="center"><FONT style="font-size:10pt" color="#1F72D0"><B>我的分类</B></FONT></TD><TD width="20"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/dot2(1).gif" border="0" title="收起" onclick="ShowHideDiv(&#39;lefttree&#39;,this);return false;"></TD></TR>
</TBODY></TABLE>

</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1"></TR>
<TR><TD bgcolor="#FFFFFF" height="1"></TR>
<TR><TD style="color:#02368D" bgcolor="F3F6F6">
<SCRIPT src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/tree.js"></SCRIPT>
<DIV style="overflow:auto;scrollbar-face-color: #EEEEEE;scrollbar-highlight-color: #FFFFFF;scrollbar-shadow-color: #CCCCCC;scrollbar-3dlight-color: #D1D7DC;scrollbar-arrow-color:#006699;scrollbar-track-color: #CCCCCC;scrollbar-darkshadow-color: #EEDFE7;" id="lefttree"><DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(1,true);"><IMG id="signContentsTree1" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Minus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/article.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(1,false);"><IMG id="iconContentsTree1" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/OpenFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/article.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(1,false);">我的文章分类</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree1" style="display:block;"><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(5,true);"><IMG id="signContentsTree5" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/article_117632.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(5,false);"><IMG id="iconContentsTree5" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/article_117632.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(5,false);">嵌入式Linux+ARM</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree5" style="display:none;"><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(6,true);"><IMG id="signContentsTree6" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/article_140698.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(6,false);"><IMG id="iconContentsTree6" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/article_140698.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(6,false);">基础篇</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree6" style="display:none;"></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(7,true);"><IMG id="signContentsTree7" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/article_140792.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(7,false);"><IMG id="iconContentsTree7" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/article_140792.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(7,false);">内核、文件系统、应用移植开发篇</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree7" style="display:none;"></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(8,true);"><IMG id="signContentsTree8" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/article_140793.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(8,false);"><IMG id="iconContentsTree8" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/article_140793.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(8,false);">Bootloader移植篇</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree8" style="display:none;"></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(9,true);"><IMG id="signContentsTree9" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/article_117641.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(9,false);"><IMG id="iconContentsTree9" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/article_117641.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(9,false);">内核、驱动开发篇</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree9" style="display:none;"></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(10,true);"><IMG id="signContentsTree10" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/article_140795.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(10,false);"><IMG id="iconContentsTree10" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/article_140795.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(10,false);">其他电子通讯技术篇</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree10" style="display:none;"></DIV></DIV></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(2,true);"><IMG id="signContentsTree2" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Minus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(2,false);"><IMG id="iconContentsTree2" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/OpenFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(2,false);">我的图片分类</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree2" style="display:block;"><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(11,true);"><IMG id="signContentsTree11" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_16460.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(11,false);"><IMG id="iconContentsTree11" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_16460.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(11,false);">嵌入式Linux+ARM</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree11" style="display:none;"><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(12,true);"><IMG id="signContentsTree12" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_16461.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(12,false);"><IMG id="iconContentsTree12" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_16461.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(12,false);">系统、应用移植</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree12" style="display:none;"><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(13,true);"><IMG id="signContentsTree13" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_16472.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(13,false);"><IMG id="iconContentsTree13" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_16472.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(13,false);">虚拟机中安装Linux</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree13" style="display:none;"></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(14,true);"><IMG id="signContentsTree14" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_16512.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(14,false);"><IMG id="iconContentsTree14" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_16512.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(14,false);">虚拟机中实现Linux与Windows之间的文件传输</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree14" style="display:none;"></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(15,true);"><IMG id="signContentsTree15" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_16525.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(15,false);"><IMG id="iconContentsTree15" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_16525.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(15,false);">开发环境的建立与Eclipse的使用</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree15" style="display:none;"></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(16,true);"><IMG id="signContentsTree16" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_16532.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(16,false);"><IMG id="iconContentsTree16" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_16532.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(16,false);">嵌入式数据库sqlite在2440上的移植</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree16" style="display:none;"></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(17,true);"><IMG id="signContentsTree17" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_16950.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(17,false);"><IMG id="iconContentsTree17" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_16950.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(17,false);">Linux-2.6.30.4在2440上的移植</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree17" style="display:none;"></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(18,true);"><IMG id="signContentsTree18" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_17160.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(18,false);"><IMG id="iconContentsTree18" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_17160.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(18,false);">U-Boot在2440上的移植</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree18" style="display:none;"></DIV></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(19,true);"><IMG id="signContentsTree19" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_16488.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(19,false);"><IMG id="iconContentsTree19" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_16488.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(19,false);">WEB应用</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree19" style="display:none;"><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(20,true);"><IMG id="signContentsTree20" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_16489.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(20,false);"><IMG id="iconContentsTree20" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_16489.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(20,false);">C+CGI+Ajax在S3C2440中的应用</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree20" style="display:none;"></DIV></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(21,true);"><IMG id="signContentsTree21" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/photo_17103.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(21,false);"><IMG id="iconContentsTree21" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/photo_17103.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(21,false);">内核、驱动开发</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree21" style="display:none;"></DIV></DIV></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(3,true);"><IMG id="signContentsTree3" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Minus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/links.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(3,false);"><IMG id="iconContentsTree3" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/OpenFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/links.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(3,false);">我的链接分类</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree3" style="display:block;"><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(22,true);"><IMG id="signContentsTree22" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/links_20167.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(22,false);"><IMG id="iconContentsTree22" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/links_20167.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(22,false);">C程序设计</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree22" style="display:none;"></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/TreeBlank.gif" alt="" width="19" height="19" style="border: 0px;"><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(23,true);"><IMG id="signContentsTree23" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Plus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/links_20335.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(23,false);"><IMG id="iconContentsTree23" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/ClosedFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/links_20335.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(23,false);">ARM Linux开发</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree23" style="display:none;"></DIV></DIV><DIV><TABLE border="0" cellspacing="0" cellpadding="0"><TBODY><TR><TD valign="middle" nowrap=""><A href="javascript:void(0)" onclick="javascript: ContentsTree.OnNodeClick(4,true);"><IMG id="signContentsTree4" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/Minus.gif" alt="" width="19" height="19" style="border: 0px;"></A><A href="http://blog.chinaunix.net/u3/101649/music.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(4,false);"><IMG id="iconContentsTree4" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/OpenFolder.gif" alt="" width="19" height="19" style="border: 0px;"></A></TD><TD valign="middle" nowrap=""><A href="http://blog.chinaunix.net/u3/101649/music.html" class="listtree" onclick="javascript: ContentsTree.OnNodeClick(4,false);">我的音乐分类</A></TD></TR></TBODY></TABLE></DIV><DIV id="divContentsTree4" style="display:block;"></DIV></DIV></DIV>
<SCRIPT language="javascript">
ContentsTree = new CTree("ContentsTree");
ContentsTree.bAutoClose = false;
ContentsTree.stTarget = "";
a0 = ContentsTree.AddNode(null, "我的文章分类", "article.html");
a0.bOpen=true;
p0 = ContentsTree.AddNode(null, "我的图片分类", "photo.html");
p0.bOpen=true;
f0 = ContentsTree.AddNode(null, "我的链接分类", "links.html");
f0.bOpen=true;
m0 = ContentsTree.AddNode(null, "我的音乐分类", "music.html");
m0.bOpen=true;
a117632 = ContentsTree.AddNode(a0, "嵌入式Linux+ARM", "article_117632.html");
a140698 = ContentsTree.AddNode(a117632, "基础篇", "article_140698.html");
a140792 = ContentsTree.AddNode(a117632, "内核、文件系统、应用移植开发篇", "article_140792.html");
a140793 = ContentsTree.AddNode(a117632, "Bootloader移植篇", "article_140793.html");
a117641 = ContentsTree.AddNode(a117632, "内核、驱动开发篇", "article_117641.html");
a140795 = ContentsTree.AddNode(a117632, "其他电子通讯技术篇", "article_140795.html");
 
p16460 = ContentsTree.AddNode(p0, "嵌入式Linux+ARM", "photo_16460.html");
p16461 = ContentsTree.AddNode(p16460, "系统、应用移植", "photo_16461.html");
p16472 = ContentsTree.AddNode(p16461, "虚拟机中安装Linux", "photo_16472.html");
p16512 = ContentsTree.AddNode(p16461, "虚拟机中实现Linux与Windows之间的文件传输", "photo_16512.html");
p16525 = ContentsTree.AddNode(p16461, "开发环境的建立与Eclipse的使用", "photo_16525.html");
p16532 = ContentsTree.AddNode(p16461, "嵌入式数据库sqlite在2440上的移植", "photo_16532.html");
p16950 = ContentsTree.AddNode(p16461, "Linux-2.6.30.4在2440上的移植", "photo_16950.html");
p17160 = ContentsTree.AddNode(p16461, "U-Boot在2440上的移植", "photo_17160.html");
p16488 = ContentsTree.AddNode(p16460, "WEB应用", "photo_16488.html");
p16489 = ContentsTree.AddNode(p16488, "C+CGI+Ajax在S3C2440中的应用", "photo_16489.html");
p17103 = ContentsTree.AddNode(p16460, "内核、驱动开发", "photo_17103.html");
 
f20167 = ContentsTree.AddNode(f0, "C程序设计", "links_20167.html");
f20335 = ContentsTree.AddNode(f0, "ARM Linux开发", "links_20335.html");
 
 
//document.write(ContentsTree.GetHTMLCode());
document.getElementById("lefttree").innerHTML=ContentsTree.GetHTMLCode();
</SCRIPT>	
</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1"></TR>
<TR><TD bgcolor="#FFFFFF" height="1"></TR>

<TR><TD><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/left_bg_bottom.gif" border="0" alt=""></TD></TR>

</TBODY></TABLE>


</TD><TD width="10"><TD valign="top" align="center">

<BR>


<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="100%">
<TBODY><TR><TD width="11" height="11"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/g_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#DDDDDD" width="99%" height="11">
<TD width="11" height="11"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/g_right_top.gif" border="0" alt=""></TD>
</TR>

<TR><TD colspan="3" width="100%" bgcolor="#DDDDDD" align="center" valign="top"> 








<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="96%">
<TBODY><TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3" width="100%">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_top.gif" border="0" alt=""></TD>
</TR>
<TR><TD colspan="3" bgcolor="#F3F3F3" align="center">

<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;" width="100%">
<TBODY><TR><TD height="25" align="center">
<FONT color="#02368D" style="font-size:14pt"><B>嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五）</B></FONT><BR>
</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1"></TR>
<TR><TD bgcolor="#FFFFFF" height="1"></TR>
<TR><TD align="center">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;" width="100%">
<TBODY><TR><TD width="100%">
<DIV id="art" width="100%" style=" margin: 15px">
<DIV>
<DIV>嵌入式Linux之我行，主要讲述和总结了本人在学习嵌入式linux中的每个步骤。一为总结经验，二希望能给想入门嵌入式Linux的朋友提供方便。如有错误之处，谢请指正。</DIV>
<UL>
<LI><FONT size="2">共享资源，欢迎转载：</FONT><A href="http://hbhuanggang.cublog.cn/"><FONT color="#0000ff" size="2">http://hbhuanggang.cublog.cn</FONT></A> </LI></UL>
<P><STRONG>一、移植环境</STRONG></P>
<UL>
<LI><FONT size="2">主 &nbsp;机：VMWare--Fedora 9</FONT> 
</LI><LI><FONT size="2">开发板：Mini2440--64MB Nand,</FONT><A href="http://www.kernel.org/pub/linux/kernel/v2.6/linux-2.6.30.4.tar.gz" target="_blank"><FONT color="#0000ff" size="2">Kernel:2.6.30.4</FONT></A> 
</LI><LI><FONT size="2">编译器：</FONT><A href="http://www.arm123.com.cn/linux/arm-linux-gcc-4.3.2.tgz" target="_blank"><FONT color="#0000ff" size="2">arm-linux-gcc-4.3.2.tgz</FONT></A> 
</LI><LI><FONT size="2">u-boot：</FONT><A href="http://ftp.denx.de/pub/u-boot/u-boot-2009.08.tar.bz2" target="_blank"><FONT color="#0000ff" size="2">u-boot-2009.08.tar.bz2</FONT></A></LI></UL>
<P><STRONG>二、移植步骤</STRONG></P>
<P><STRONG>上接</STRONG>：<A href="http://blog.chinaunix.net/u3/101649/showart_2126764.html" target="_blank"><STRONG>u-boot-2009.08在2440上的移植详解（四）</STRONG></A></P></DIV>
<DIV><STRONG><FONT face="宋体" size="2">9）实现u-boot对yaffs/yaffs2文件系统下载的支持。</FONT></STRONG></DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;&nbsp;&nbsp; <FONT face="宋体"><FONT size="2">注意：此篇对Nand的操作是基于MTD架构方式，在“<FONT color="#000000">u-boot-2009.08在2440上的移植详解（三）”中讲到过。</FONT></FONT></FONT></DIV>
<DIV><FONT face="宋体" size="2"></FONT>&nbsp;</DIV>
<DIV><FONT face="宋体" size="2">&nbsp;&nbsp;&nbsp; 通常一个Nnad Flash存储设备由若干块组成，1个块由若干页组成。一般128MB以下容量的Nand Flash芯片，一页大小为528B，被依次分为2个256B的主数据区和16B的额外空间；128MB以上容量的Nand Flash芯片，一页大小通常为2KB。由于Nand Flash出现位反转的概率较大，一般在读写时需要使用ECC进行错误检验和恢复。</FONT></DIV>
<DIV><FONT face="宋体" size="2"></FONT>&nbsp;</DIV>
<DIV><FONT face="宋体" size="2">&nbsp;&nbsp;&nbsp; Yaffs/yaffs2文件系统的设计充分考虑到Nand Flash以页为存取单位等的特点，将文件组织成固定大小的段(Chunk)。以528B的页为例，Yaffs/yaffs2文件系统使用前512B存储数据和16B的额外空间存放数据的ECC和文件系统的组织信息等(称为OOB数据)。通过OOB数据，不但能实现错误检测和坏块处理，同时还可以避免加载时对整个存储介质的扫描，加快了文件系统的加载速度。以下是Yaffs/yaffs2文件系统页的结构说明：</FONT> 
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Yaffs页结构说明<BR><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">====</SPAN><BR>&nbsp;&nbsp;&nbsp;字节&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 用途<BR><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">====</SPAN><BR>&nbsp;0 - 511&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 存储数据(分为两个半部)<BR>512 - 515&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 系统信息<BR>&nbsp;&nbsp;&nbsp;516&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 数据状态字<BR>&nbsp;&nbsp;&nbsp;517&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 块状态字<BR>518 - 519&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 系统信息<BR>520 - 522&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 后半部256字节的ECC<BR>523 - 524&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 系统信息<BR>525 - 527&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 前半部256字节的ECC<BR><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">=</SPAN><SPAN style="COLOR: #0000cc">====</SPAN></FONT></SPAN></CODE></P></TD></TR></TBODY></TABLE></DIV>
<DIV><BR>&nbsp;&nbsp;&nbsp; <FONT face="宋体" size="2">好了，在了解Nand Flash组成和Yaffs/yaffs2文件系统结构后，我们再回到u-boot中。目前，在u-boot中已经有对Cramfs、Jffs2等文件系统的读写支持，但与带有数据校验等功能的OOB区的Yaffs/Yaffs2文件系统相比，他们是将所有文件数据简单的以线性表形式组织的。所以，我们只要在此基础上通过修改u-boot的Nand Flash读写命令，增加处理00B区域数据的功能，即可以实现对Yaffs/Yaffs2文件系统的读写支持。</FONT></DIV><BR>
<DIV></DIV>
<DIV>实现对Yaffs或者Yaffs2文件系统的读写支持步骤如下：</DIV>
<DIV><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><STRONG>①、</STRONG><FONT size="2">在include/configs/my2440.h头文件中定义一个管理对Yaffs2支持的宏和开启u-boot中对Nand Flash默认分区的宏，如下：</FONT></SPAN></DIV>
<DIV><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><FONT size="2">
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">#gedit include/configs/my2440.h&nbsp; <FONT color="#ff9900">//添加到文件末尾即可</FONT></FONT></SPAN></CODE></P></TD></TR></TBODY></TABLE></FONT></SPAN></DIV><FONT size="2">
</FONT><DIV><FONT size="2">
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="宋体"><FONT color="#ff0000">#define CONFIG_MTD_NAND_YAFFS2&nbsp;&nbsp;&nbsp;1</FONT> <FONT color="#ff9900">//</FONT><FONT color="#ff9900">定义一个管理对Yaffs2支持的宏</FONT><BR></FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="宋体"><FONT color="#ff9900">//开启Nand Flash默认分区，注意此处的分区要和你的内核中的分区保持一致</FONT><BR></FONT><FONT face="宋体"><FONT color="#ff0000">#define MTDIDS_DEFAULT <SPAN style="COLOR: #ff00ff"><FONT color="#ff0000">"</FONT><FONT color="#ff0000">nand0=nandflash0</FONT><FONT color="#ff0000">"</FONT></SPAN><BR>#define MTDPARTS_DEFAULT <SPAN style="COLOR: #ff00ff"><FONT color="#ff0000">"mtdparts=nandflash0:192k(bootloader),"</FONT></SPAN> \<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #ff00ff"><FONT color="#ff0000">"64k(params),"</FONT></SPAN> \<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: #ff00ff"><FONT color="#ff0000">"2m(kernel),"</FONT></SPAN> \<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><SPAN style="COLOR: #ff00ff"><FONT color="#ff0000">"-(root)"</FONT></SPAN></FONT></SPAN></CODE></P></TD></TR></TBODY></TABLE></FONT><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"></SPAN></DIV>
<P><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><STRONG><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA">②</SPAN>、</STRONG><FONT size="2">在原来对Nand操作的命令集列表中添加Yaffs2对Nand的写命令，如下： 
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">#gedit common/cmd_nand.c&nbsp;&nbsp; <FONT color="#ff9900">//在U_BOOT_CMD中添加</FONT></FONT></SPAN></CODE></P></TD></TR></TBODY></TABLE>
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P>U_BOOT_CMD(nand, CONFIG_SYS_MAXARGS, 1, do_nand,<BR>&nbsp;&nbsp;&nbsp; "NAND sub-system",<BR>&nbsp;&nbsp;&nbsp; "info - show available NAND devices\n"<BR>&nbsp;&nbsp;&nbsp; "nand device [dev] - show or set current device\n"<BR>&nbsp;&nbsp;&nbsp; "nand read - addr off|partition size\n"<BR>&nbsp;&nbsp;&nbsp; "nand write - addr off|partition size\n"<BR>&nbsp;&nbsp;&nbsp; " read/write 'size' bytes starting at offset 'off'\n"<BR>&nbsp;&nbsp;&nbsp; " to/from memory address 'addr', skipping bad blocks.\n"</P>
<P><FONT color="#ff9900">//注意：这里只添加了yaffs2的写命令，因为我们只用u-boot下载(即写)功能，所以我们没有添加yaffs2读的命令<BR></FONT><FONT color="#ff0000">#if defined(CONFIG_MTD_NAND_YAFFS2)<BR>&nbsp;&nbsp;&nbsp; "nand write[.yaffs2] - addr off|partition size - write `size' byte yaffs image\n"<BR>&nbsp;&nbsp;&nbsp; "&nbsp;starting at offset off' from memory address addr' (.yaffs2 for 512+16 NAND)\n"<BR>#endif</FONT></P>
<P><FONT color="#ff0000"><BR></FONT>&nbsp;&nbsp;&nbsp; "nand erase [clean] [off size] - erase 'size' bytes from\n"<BR>&nbsp;&nbsp;&nbsp; " offset 'off' (entire device if not specified)\n"<BR>&nbsp;&nbsp;&nbsp; "nand bad - show bad blocks\n"<BR>&nbsp;&nbsp;&nbsp; "nand dump[.oob] off - dump page\n"<BR>&nbsp;&nbsp;&nbsp; "nand scrub - really clean NAND erasing bad blocks (UNSAFE)\n"<BR>&nbsp;&nbsp;&nbsp; "nand markbad off [...] - mark bad block(s) at offset (UNSAFE)\n"<BR>&nbsp;&nbsp;&nbsp; "nand biterr off - make a bit error at offset (UNSAFE)"<BR>#ifdef CONFIG_CMD_NAND_LOCK_UNLOCK<BR>&nbsp;&nbsp;&nbsp; "\n"<BR>&nbsp;&nbsp;&nbsp; "nand lock [tight] [status]\n"<BR>&nbsp;&nbsp;&nbsp; " bring nand to lock state or display locked pages\n"<BR>&nbsp;&nbsp;&nbsp; "nand unlock [offset] [size] - unlock section"<BR>#endif<BR>);</P></TD></TR></TBODY></TABLE><BR></FONT></SPAN></P>
<P><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"></SPAN><FONT face="宋体"></FONT>接着，在该文件中对nand操作的do_nand函数中添加yaffs2对nand的操作，如下： 
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P><FONT face="宋体">&nbsp;&nbsp;&nbsp; if (strncmp(cmd, "read", 4) == 0 || strncmp(cmd, "write", 5) == 0) <BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int read;</FONT></P>
<P><FONT face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (argc &lt; 4)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; goto usage;</FONT></P>
<P><FONT face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; addr = (ulong)simple_strtoul(argv[2], NULL, 16);</FONT></P>
<P><FONT face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; read = strncmp(cmd, "read", 4) == 0; /* 1 = read, 0 = write */<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("\nNAND %s: ", read ? "read" : "write");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (arg_off_size(argc - 3, argv + 3, nand, &amp;off, &amp;size) != 0)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 1;</FONT></P>
<P><FONT face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s = strchr(cmd, '.');<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!s || !strcmp(s, ".jffs2") || !strcmp(s, ".e") || !strcmp(s, ".i")) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (read)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret = nand_read_skip_bad(nand, off, &amp;size, (u_char *)addr);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret = nand_write_skip_bad(nand, off, &amp;size, (u_char *)addr);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</FONT></P>
<P><FONT face="宋体" color="#ff9900">//添加yaffs2相关操作，注意该处又关联到nand_write_skip_bad函数</FONT></P>
<P><FONT face="宋体" color="#ff0000">#if defined(CONFIG_MTD_NAND_YAFFS2)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (s != NULL &amp;&amp; (!strcmp(s, ".yaffs2")))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nand-&gt;rw_oob = 1;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nand-&gt;skipfirstblk = 1;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret = nand_write_skip_bad(nand,off,&amp;size,(u_char *)addr);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nand-&gt;skipfirstblk = 0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nand-&gt;rw_oob = 0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>#endif</FONT></P>
<P><FONT face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (!strcmp(s, ".oob")) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* out-of-band data */<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mtd_oob_ops_t ops = <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .oobbuf = (u8 *)addr,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .ooblen = size,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .mode = MTD_OOB_RAW<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };</FONT></P>
<P><FONT face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (read)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret = nand-&gt;read_oob(nand, off, &amp;ops);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret = nand-&gt;write_oob(nand, off, &amp;ops);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("Unknown nand command suffix '%s'.\n", s);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 1;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</FONT></P>
<P><FONT face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(" %zu bytes %s: %s\n", size, read ? "read" : "written", ret ? "ERROR" : "OK");</FONT></P>
<P><FONT face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return ret == 0 ? 0 : 1;<BR>&nbsp;&nbsp;&nbsp; }</FONT></P></TD></TR></TBODY></TABLE><BR><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><STRONG>③、</STRONG><FONT size="2">在include/linux/mtd/mtd.h头文件的mtd_info结构体中添加上面用到rw_oob和skipfirstblk数据成员，如下： 
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">#gedit include/linux/mtd/mtd.h&nbsp;&nbsp; <FONT color="#ff9900">//在mtd_info结构体中添加</FONT></FONT></SPAN></CODE></P></TD></TR></TBODY></TABLE>
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="宋体" color="#ff0000">#if defined(CONFIG_MTD_NAND_YAFFS2)<BR>&nbsp;&nbsp;&nbsp;&nbsp;u_char rw_oob;<BR>&nbsp;&nbsp;&nbsp;&nbsp;u_char skipfirstblk;<BR>#endif</FONT></SPAN></CODE></P></TD></TR></TBODY></TABLE></FONT></SPAN><BR><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><STRONG>④、</STRONG><FONT size="2">在第二步关联的<FONT color="#000000">nand_write_skip_bad函数中添加对Nand OOB的相关操作，如下： 
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">#gedit drivers/mtd/nand/nand_util.c&nbsp; <FONT color="#ff9900">//在</FONT></FONT><FONT face="宋体" color="#ff9900">nand_write_skip_bad函数中添加</FONT></SPAN></CODE></P></TD></TR></TBODY></TABLE>
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P>int nand_write_skip_bad(nand_info_t *nand, loff_t offset, size_t *length, u_char *buffer)<BR>{<BR>&nbsp;&nbsp;&nbsp; int rval;<BR>&nbsp;&nbsp;&nbsp; size_t left_to_write = *length;<BR>&nbsp;&nbsp;&nbsp; size_t len_incl_bad;<BR>&nbsp;&nbsp;&nbsp; u_char *p_buffer = buffer;</P>
<P><FONT color="#ff0000">#if defined(CONFIG_MTD_NAND_YAFFS2) <FONT color="#ff9900">//add yaffs2 file system support<BR></FONT>&nbsp;&nbsp;&nbsp; if(nand-&gt;rw_oob==1)&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size_t oobsize = nand-&gt;oobsize;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size_t datasize = nand-&gt;writesize;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int datapages = 0;</FONT></P>
<P><FONT color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (((*length)%(nand-&gt;oobsize+nand-&gt;writesize)) != 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf ("Attempt to write error length data!\n");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -EINVAL;<BR>&nbsp;&nbsp;&nbsp;&nbsp; }</FONT></P>
<P><FONT color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; datapages = *length/(datasize+oobsize);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *length = datapages*datasize;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; left_to_write = *length;<BR>&nbsp;&nbsp;&nbsp; }<BR>#endif</FONT></P>
<P>&nbsp;&nbsp;&nbsp; /* Reject writes, which are not page aligned */<BR>&nbsp;&nbsp;&nbsp; if ((offset &amp; (nand-&gt;writesize - 1)) != 0 ||<BR>&nbsp;&nbsp;&nbsp;&nbsp; (*length &amp; (nand-&gt;writesize - 1)) != 0) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf ("Attempt to write non page aligned data\n");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -EINVAL;<BR>&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp; len_incl_bad = get_len_incl_bad (nand, offset, *length);</P>
<P>&nbsp;&nbsp;&nbsp; if ((offset + len_incl_bad) &gt;= nand-&gt;size) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf ("Attempt to write outside the flash area\n");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -EINVAL;<BR>&nbsp;&nbsp;&nbsp; }</P>
<P><FONT color="#ff0000">#if !defined(CONFIG_MTD_NAND_YAFFS2) <FONT color="#ff9900">//add yaffs2 file system support</FONT><BR>&nbsp;&nbsp;&nbsp; if (len_incl_bad == *length) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rval = nand_write (nand, offset, length, buffer);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (rval != 0)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf ("NAND write to offset %llx failed %d\n",<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; offset, rval);</FONT></P>
<P><FONT color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return rval;<BR>&nbsp;&nbsp;&nbsp; }<BR>#endif</FONT></P>
<P>&nbsp;&nbsp;&nbsp; while (left_to_write &gt; 0) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size_t block_offset = offset &amp; (nand-&gt;erasesize - 1);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size_t write_size;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WATCHDOG_RESET ();</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (nand_block_isbad (nand, offset &amp; ~(nand-&gt;erasesize - 1))) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf ("Skip bad block 0x%08llx\n",<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; offset &amp; ~(nand-&gt;erasesize - 1));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; offset += nand-&gt;erasesize - block_offset;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P><FONT color="#ff0000">#if defined(CONFIG_MTD_NAND_YAFFS2) <FONT color="#ff9900">//add yaffs2 file system support</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(nand-&gt;skipfirstblk==1)&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nand-&gt;skipfirstblk=0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf ("Skip the first good block %llx\n", offset &amp; ~(nand-&gt;erasesize - 1));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; offset += nand-&gt;erasesize - block_offset;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>#endif</FONT></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (left_to_write &lt; (nand-&gt;erasesize - block_offset))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; write_size = left_to_write;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; write_size = nand-&gt;erasesize - block_offset;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="#ff0000">printf("\rWriting at 0x%llx -- ",offset);</FONT> <FONT color="#ff9900">//add yaffs2 file system support</FONT></P>
<P><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rval = nand_write (nand, offset, &amp;write_size, p_buffer);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (rval != 0) {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf ("NAND write to offset %llx failed %d\n",<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; offset, rval);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *length -= left_to_write;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return rval;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; left_to_write -= write_size;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("%d%% is complete.",100-(left_to_write/(*length/100)));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; offset += write_size;</P>
<P><FONT color="#ff0000">#if defined(CONFIG_MTD_NAND_YAFFS2) <FONT color="#ff9900">//add yaffs2 file system support</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(nand-&gt;rw_oob==1)&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p_buffer += write_size+(write_size/nand-&gt;writesize*nand-&gt;oobsize);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p_buffer += write_size;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>#else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p_buffer += write_size;<BR>#endif</FONT></P>
<P>&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp; return 0;<BR>}</P></TD></TR></TBODY></TABLE></FONT></FONT></SPAN></SPAN></SPAN><BR><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><STRONG>⑤、</STRONG><FONT size="2">在第四步nand_write_skip_bad函数中我们看到又对nand_write函数进行了访问，所以这一步是到nand_write函数中添加对yaffs2的支持，如下： 
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">#gedit drivers/mtd/nand/nand_base.c&nbsp; <FONT color="#ff9900">//在</FONT></FONT><FONT face="宋体" color="#ff9900">nand_write函数中添加</FONT></SPAN></CODE></P></TD></TR></TBODY></TABLE>
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">static int nand_write(struct mtd_info *mtd, loff_t to, size_t len, size_t *retlen, const uint8_t *buf)<BR>{<BR>&nbsp;&nbsp;&nbsp; struct nand_chip *chip = mtd-&gt;priv;<BR>&nbsp;&nbsp;&nbsp; int ret;</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="新宋体"></FONT></SPAN></CODE>&nbsp;</P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun" color="#ff0000">#if defined(CONFIG_MTD_NAND_YAFFS2) <FONT color="#ff9900">//add yaffs2 file system support</FONT></FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun" color="#ff0000">&nbsp;&nbsp;&nbsp; int oldopsmode = 0;</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun" color="#ff0000">&nbsp;&nbsp;&nbsp; if(mtd-&gt;rw_oob==1)&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int i = 0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int datapages = 0;</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun" color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size_t oobsize = mtd-&gt;oobsize;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; size_t datasize = mtd-&gt;writesize;</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun" color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; uint8_t oobtemp[oobsize];<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; datapages = len / (datasize);</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun" color="#ff0000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(i = 0; i &lt; (datapages); i++)&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memcpy((void *)oobtemp, (void *)(buf + datasize * (i + 1)), oobsize);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memmove((void *)(buf + datasize * (i + 1)), (void *)(buf + datasize * (i + 1) + oobsize), (datapages - (i + 1)) * (datasize) + (datapages - 1) * oobsize);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memcpy((void *)(buf+(datapages) * (datasize + oobsize) - oobsize), (void *)(oobtemp), oobsize);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR>#endif</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="新宋体"></FONT></SPAN></CODE>&nbsp;</P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">&nbsp;&nbsp;&nbsp; /* Do not allow reads past end of device */<BR>&nbsp;&nbsp;&nbsp; if ((to + len) &gt; mtd-&gt;size)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -EINVAL;<BR>&nbsp;&nbsp;&nbsp; if (!len)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">&nbsp;&nbsp;&nbsp; nand_get_device(chip, mtd, FL_WRITING);</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">&nbsp;&nbsp;&nbsp; chip-&gt;ops.len = len;<BR>&nbsp;&nbsp;&nbsp; chip-&gt;ops.datbuf = (uint8_t *)buf;</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="新宋体"></FONT></SPAN></CODE>&nbsp;</P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun" color="#ff0000">#if defined(CONFIG_MTD_NAND_YAFFS2) <FONT color="#ff9900">//add yaffs2 file system support</FONT></FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun" color="#ff0000">&nbsp;&nbsp;&nbsp; if(mtd-&gt;rw_oob!=1)&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chip-&gt;ops.oobbuf = NULL;<BR>&nbsp;&nbsp;&nbsp; } <BR>&nbsp;&nbsp;&nbsp; else&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chip-&gt;ops.oobbuf = (uint8_t *)(buf + len);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chip-&gt;ops.ooblen = mtd-&gt;oobsize;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldopsmode = chip-&gt;ops.mode;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; chip-&gt;ops.mode = MTD_OOB_RAW;<BR>&nbsp;&nbsp;&nbsp; }<BR>#else<BR>&nbsp;&nbsp;&nbsp; chip-&gt;ops.oobbuf = NULL;<BR>#endif</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="新宋体"></FONT></SPAN></CODE>&nbsp;</P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">&nbsp;&nbsp;&nbsp; ret = nand_do_write_ops(mtd, to, &amp;chip-&gt;ops);</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">&nbsp;&nbsp;&nbsp; *retlen = chip-&gt;ops.retlen;</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">&nbsp;&nbsp;&nbsp; nand_release_device(mtd);</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="新宋体"></FONT></SPAN></CODE>&nbsp;</P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun" color="#ff0000">#if defined(CONFIG_MTD_NAND_YAFFS2) <FONT color="#ff9900">//add yaffs2 file system support</FONT></FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun" color="#ff0000">&nbsp;&nbsp;&nbsp; chip-&gt;ops.mode = oldopsmode;<BR>#endif</FONT></SPAN></CODE></P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="新宋体"></FONT></SPAN></CODE>&nbsp;</P>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">&nbsp;&nbsp;&nbsp; return ret;<BR>}</FONT></SPAN></CODE></P></TD></TR></TBODY></TABLE></FONT></SPAN></SPAN></SPAN><BR>OK，对yaffs2支持的代码已修改完毕，重新编译u-boot并下载到nand中，启动开发板，在u-boot的命令行输入:nand help查看nand的命令，可以看到多了一个<FONT color="#000000"><FONT face="宋体">nand write[.yaffs2]的命令，这个就是用来下载yaffs2文件系统到nand中的命令了。</FONT></FONT></P>
<P><FONT color="#000000"><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><STRONG>⑥、</STRONG><FONT size="2">使用nand write[.yaffs2]命令把事前制作好的yaffs2文件系统下载到Nand Flash中(yaffs2文件系统的制作请参考：<A href="http://blog.chinaunix.net/u3/101649/showart_2075312.html" target="_blank"><FONT face="Courier New" color="#810081">Linux-2.6.30.4在2440上的移植之文件系统</FONT></A>)，下载操作步骤和效果图如下： 
<TABLE style="BORDER-COLLAPSE: collapse" bordercolor="#999999" cellspacing="0" cellpadding="0" width="95%" bgcolor="#f1f1f1" border="1">
<TBODY>
<TR>
<TD>
<P style="MARGIN: 5px; LINE-HEIGHT: 150%"><CODE><SPAN style="COLOR: #000000"><FONT face="NSimsun">tftp 0x30000000 root-2.6.30.4.bin <FONT color="#ff9900">//用tftp将yaffs2文件系统下载到内存的0x30000000位置</FONT><BR><BR>nand erase 0x250000 0x3dac000 <FONT color="#ff9900">//擦除Nand的文件系统分区</FONT><BR><BR>nand write.yaffs2 0x30000000 0x250000 0x658170 <FONT color="#ff9900">//将内存中的yaffs2文件系统写入Nand的文件系统分区，注意这里的0x658170是yaffs2文件系统的实际大小(可以在tftp传送完后可以看到)，要写正确，否则会形成假坏块</FONT></FONT></SPAN></CODE></P></TD></TR></TBODY></TABLE></FONT></SPAN><BR></FONT><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/101649_100103193104.png"><BR></P>
<DIV></DIV>
<DIV></DIV>
<P><BR><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><STRONG>⑦、</STRONG><FONT size="2">结合u-boot和内核来测试启动下载的yaffs2文件系统<BR>设置u-boot启动参数bootargs，注意：这一长串参数要与内核配置里面的Boot options--&gt;Default kernel command string的设置要一致。特别是mtdblock3要根据内核具体的分区来设，在上一篇中讲到了内核中Nand的分区情况，u-boot属于mtdblock0，param属于mtdblock1，kernel属于mtdblock2，root就属于mtdblock3，所以这里要设置成root=/dev/mtdblock3，否则文件系统无法启动成功，会出现一些什么I/O之类的错误<BR><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/101649_100103195908.png"></FONT></SPAN></P>
<P><SPAN style="FONT-SIZE: 10.5pt; FONT-FAMILY: 宋体; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><FONT size="2">好了，最后重启开发板，内核引导成功，yaffs2文件系统也挂载成功，效果图如下：<BR><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/101649_100103195933.png"></FONT></SPAN></P>
<P>&nbsp;</P>
<DIV></DIV>
</DIV>
</TD></TR>
</TBODY></TABLE>


<P style="line-height: 150%; margin: 5px">
 
<A href="http://blog.chinaunix.net/u3/101649/showart.php?id=2276917" target="_blank">回目录 嵌入式Linux之我行――Bootloader移植篇 </A>
 
</P>
</TD></TR>
 
<TR><TD height="25">
&nbsp;<FONT color="#000099"><B>TAG</B></FONT>

<A href="http://blog.chinaunix.net/tag.php?q=u-boot-2009.08%D2%C6%D6%B2" target="_blank" style="color:#FF0000">u-boot-2009.08移植</A>
<A href="http://blog.chinaunix.net/tag.php?q=yaffs2" target="_blank" style="color:#FF0000">yaffs2</A>
 
<A href="http://blog.chinaunix.net/tag.php?q=2440" target="_blank" style="color:#FF0000">2440</A>
 
</TD></TR>
 
<TR><TD height="25" align="center">
<FONT color="#295200">发表于： 2009-12-29，修改于： 2010-01-06 11:34，已浏览2973次，有评论9条</FONT> 
<A href="http://blog.chinaunix.net/u2/star.php?blogid=101649&artid=2134240" id="star" onclick="NewWindows(this.href);return false;" title="推荐这篇文章">推荐</A>
<A href="http://blog.chinaunix.net/u2/complaint.php?blogid=101649&artid=2134240" id="complaint" onclick="NewWindows(this.href);return false;" title="投诉这篇文章">投诉</A>
</TD></TR>




</TBODY></TABLE>


</TD></TR>
<TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_buttom.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_buttom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>


</TD></TR><TR><TD width="11" height="11"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/g_left_bottom.gif" border="0" alt=""></TD>
<TD bgcolor="#DDDDDD">
<TD width="11" height="11"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/g_right_bottom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>
<BR>
<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="100%">
<TBODY><TR><TD width="11" height="11"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/g_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#DDDDDD" width="99%" height="11">
<TD width="11" height="11"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/g_right_top.gif" border="0" alt=""></TD>
</TR>

<TR><TD colspan="3" width="100%" bgcolor="#DDDDDD" align="center" valign="top"> 
<B>网友评论</B>
<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="96%">
<TBODY><TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3" width="100%">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_top.gif" border="0" alt=""></TD>
</TR>
<TR><TD colspan="3" bgcolor="#F3F3F3" align="center">

<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;color:#02368D;" width="700" align="center">
<TBODY><TR height="25">
<TD width="25"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/dot.gif" width="8" height="8" border="0" alt=""></TD>
<TD width="120">网友：<B>
本站网友</B> </TD><TD width="555" align="right" style="color:#AAAAAA">时间：2010-07-21 16:21:58    IP地址：111.164.162.★</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1" colspan="3"></TR>
<TR><TD bgcolor="#FFFFFF" height="1" colspan="3"></TR>
<TR>
<TD colspan="3">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;" bordercolor="#111111" width="700">
<TBODY><TR><TD valign="top" width="20"><TD width="580">
<PRE style="line-height: 150%; margin: 0px;" wrap="break-word">博主的文章写的很详细，受益匪浅。<BR>
先问一下uboot中设置dm9000，bank4&nbsp;时序的代码在哪？<BR>
是在lowleve_init.S中吗？</PRE>
</TD></TR>
</TBODY></TABLE>

</TD>
</TR>
<TR><TD height="15" colspan="3"></TR>
</TBODY></TABLE>


</TD></TR>
<TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_buttom.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_buttom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>
<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="96%">
<TBODY><TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3" width="100%">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_top.gif" border="0" alt=""></TD>
</TR>
<TR><TD colspan="3" bgcolor="#F3F3F3" align="center">

<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;color:#02368D;" width="700" align="center">
<TBODY><TR height="25">
<TD width="25"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/dot.gif" width="8" height="8" border="0" alt=""></TD>
<TD width="120">网友：<B>
本站网友</B> </TD><TD width="555" align="right" style="color:#AAAAAA">时间：2010-07-24 05:13:13    IP地址：113.118.172.★</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1" colspan="3"></TR>
<TR><TD bgcolor="#FFFFFF" height="1" colspan="3"></TR>
<TR>
<TD colspan="3">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;" bordercolor="#111111" width="700">
<TBODY><TR><TD valign="top" width="20"><TD width="580">
<PRE style="line-height: 150%; margin: 0px;" wrap="break-word">内行写的东西真的是不一样，对我学习很大帮助，要是我买的书能有这样的作者就好了，韦东山除外</PRE>
</TD></TR>
</TBODY></TABLE>

</TD>
</TR>
<TR><TD height="15" colspan="3"></TR>
</TBODY></TABLE>


</TD></TR>
<TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_buttom.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_buttom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>
<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="96%">
<TBODY><TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3" width="100%">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_top.gif" border="0" alt=""></TD>
</TR>
<TR><TD colspan="3" bgcolor="#F3F3F3" align="center">

<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;color:#02368D;" width="700" align="center">
<TBODY><TR height="25">
<TD width="25"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/dot.gif" width="8" height="8" border="0" alt=""></TD>
<TD width="120">网友：<B>
本站网友</B> </TD><TD width="555" align="right" style="color:#AAAAAA">时间：2010-07-24 05:14:01    IP地址：113.118.172.★</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1" colspan="3"></TR>
<TR><TD bgcolor="#FFFFFF" height="1" colspan="3"></TR>
<TR>
<TD colspan="3">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;" bordercolor="#111111" width="700">
<TBODY><TR><TD valign="top" width="20"><TD width="580">
<PRE style="line-height: 150%; margin: 0px;" wrap="break-word">内行写的东西真的是不一样，对我学习很大帮助，要是我买的书能有这样的作者就好了，韦东山除外</PRE>
</TD></TR>
</TBODY></TABLE>

</TD>
</TR>
<TR><TD height="15" colspan="3"></TR>
</TBODY></TABLE>


</TD></TR>
<TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_buttom.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_buttom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>
<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="96%">
<TBODY><TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3" width="100%">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_top.gif" border="0" alt=""></TD>
</TR>
<TR><TD colspan="3" bgcolor="#F3F3F3" align="center">

<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;color:#02368D;" width="700" align="center">
<TBODY><TR height="25">
<TD width="25"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/dot.gif" width="8" height="8" border="0" alt=""></TD>
<TD width="120">网友：<B>
本站网友</B> </TD><TD width="555" align="right" style="color:#AAAAAA">时间：2010-08-24 22:38:01    IP地址：60.190.128.★</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1" colspan="3"></TR>
<TR><TD bgcolor="#FFFFFF" height="1" colspan="3"></TR>
<TR>
<TD colspan="3">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;" bordercolor="#111111" width="700">
<TBODY><TR><TD valign="top" width="20"><TD width="580">
<PRE style="line-height: 150%; margin: 0px;" wrap="break-word">nand&nbsp;erase&nbsp;0x50000&nbsp;0x200000&nbsp;//擦除nand的0x50000-0x200000的内容<BR>
<BR>
nand&nbsp;write&nbsp;0x30000000&nbsp;0x50000&nbsp;0x200000&nbsp;//将内存0x30000000处的内容写入到nand的0x50000处<BR>
<BR>
请问上面两个0x200000是地址末端&nbsp;还是&nbsp;偏移地址大小？</PRE>
</TD></TR>
</TBODY></TABLE>

</TD>
</TR>
<TR><TD height="15" colspan="3"></TR>
</TBODY></TABLE>


</TD></TR>
<TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_buttom.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_buttom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>
<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="96%">
<TBODY><TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3" width="100%">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_top.gif" border="0" alt=""></TD>
</TR>
<TR><TD colspan="3" bgcolor="#F3F3F3" align="center">

<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;color:#02368D;" width="700" align="center">
<TBODY><TR height="25">
<TD width="25"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/dot.gif" width="8" height="8" border="0" alt=""></TD>
<TD width="120">网友：<B>
本站网友</B> </TD><TD width="555" align="right" style="color:#AAAAAA">时间：2010-08-30 09:33:51    IP地址：202.207.25.★</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1" colspan="3"></TR>
<TR><TD bgcolor="#FFFFFF" height="1" colspan="3"></TR>
<TR>
<TD colspan="3">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;" bordercolor="#111111" width="700">
<TBODY><TR><TD valign="top" width="20"><TD width="580">
<PRE style="line-height: 150%; margin: 0px;" wrap="break-word">#ifdef&nbsp;CONFIG_S3C2440_NAND_BOOT<BR>
&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;r1,&nbsp;#NAND_CTL_BASE&nbsp;&nbsp;&nbsp;//复位Nand&nbsp;Flash<BR>
&nbsp;&nbsp;&nbsp;&nbsp;ldr&nbsp;r2,&nbsp;=(&nbsp;(7&lt;&lt;12)|(7&lt;&lt;8)|(7&lt;&lt;4)|(0&lt;&lt;0)&nbsp;)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;r2,&nbsp;[r1,&nbsp;#oNFCONF]&nbsp;&nbsp;&nbsp;//设置配置寄存器的初始值，参考s3c2440手册<BR>
&nbsp;&nbsp;&nbsp;&nbsp;ldr&nbsp;r2,&nbsp;[r1,&nbsp;#oNFCONF]<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;ldr&nbsp;r2,&nbsp;=(&nbsp;(1&lt;&lt;4)|(0&lt;&lt;1)|(1&lt;&lt;0)&nbsp;)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;r2,&nbsp;[r1,&nbsp;#oNFCONT]&nbsp;&nbsp;&nbsp;//设置控制寄存器<BR>
&nbsp;&nbsp;&nbsp;&nbsp;ldr&nbsp;r2,&nbsp;[r1,&nbsp;#oNFCONT]<BR>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;ldr&nbsp;r2,&nbsp;=(0x6)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//RnB&nbsp;Clear<BR>
&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;r2,&nbsp;[r1,&nbsp;#oNFSTAT]<BR>
&nbsp;&nbsp;&nbsp;&nbsp;ldr&nbsp;r2,&nbsp;[r1,&nbsp;#oNFSTAT]<BR>
<BR>
这段代码中&nbsp;str后又ldr。然后下面又使用ldr的伪指令。我觉得str后的ldr没用。又把NAND寄存器中的值赋给通用寄存器。下面又从新赋值了啊</PRE>
</TD></TR>
</TBODY></TABLE>

</TD>
</TR>
<TR><TD height="15" colspan="3"></TR>
</TBODY></TABLE>


</TD></TR>
<TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_buttom.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_buttom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>
<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="96%">
<TBODY><TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3" width="100%">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_top.gif" border="0" alt=""></TD>
</TR>
<TR><TD colspan="3" bgcolor="#F3F3F3" align="center">

<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;color:#02368D;" width="700" align="center">
<TBODY><TR height="25">
<TD width="25"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/dot.gif" width="8" height="8" border="0" alt=""></TD>
<TD width="120">网友：<B>
本站网友</B> </TD><TD width="555" align="right" style="color:#AAAAAA">时间：2010-08-30 09:36:26    IP地址：202.207.25.★</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1" colspan="3"></TR>
<TR><TD bgcolor="#FFFFFF" height="1" colspan="3"></TR>
<TR>
<TD colspan="3">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;" bordercolor="#111111" width="700">
<TBODY><TR><TD valign="top" width="20"><TD width="580">
<PRE style="line-height: 150%; margin: 0px;" wrap="break-word">&nbsp;ldr&nbsp;r2,&nbsp;=(&nbsp;(7&lt;&lt;12)|(7&lt;&lt;8)|(7&lt;&lt;4)|(0&lt;&lt;0)&nbsp;)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;r2,&nbsp;[r1,&nbsp;#oNFCONF]&nbsp;&nbsp;&nbsp;//设置配置寄存器的初始值，参考s3c2440手册<BR>
&nbsp;&nbsp;我对这里使用&nbsp;&nbsp;ldr&nbsp;r2,&nbsp;[r1,&nbsp;#oNFCONF]&nbsp;&nbsp;不理解。。<BR>
我觉得应该不用这个ldr<BR>
<BR>
</PRE>
</TD></TR>
</TBODY></TABLE>

</TD>
</TR>
<TR><TD height="15" colspan="3"></TR>
</TBODY></TABLE>


</TD></TR>
<TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_buttom.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_buttom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>
<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="96%">
<TBODY><TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3" width="100%">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_top.gif" border="0" alt=""></TD>
</TR>
<TR><TD colspan="3" bgcolor="#F3F3F3" align="center">

<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;color:#02368D;" width="700" align="center">
<TBODY><TR height="25">
<TD width="25"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/dot.gif" width="8" height="8" border="0" alt=""></TD>
<TD width="120">网友：<B>
本站网友</B> </TD><TD width="555" align="right" style="color:#AAAAAA">时间：2010-09-04 14:32:34    IP地址：202.111.154.★</TD></TR>
<TR><TD bgcolor="#D2DEE2" height="1" colspan="3"></TR>
<TR><TD bgcolor="#FFFFFF" height="1" colspan="3"></TR>
<TR>
<TD colspan="3">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse;word-wrap:break-word;" bordercolor="#111111" width="700">
<TBODY><TR><TD valign="top" width="20"><TD width="580">
<PRE style="line-height: 150%; margin: 0px;" wrap="break-word">非常博主的精彩文章，受益匪浅！不过在移植过程中有几点疑惑，尚请解答一二。首先，//开启Nand&nbsp;Flash默认分区，注意此处的分区要和你的内核中的分区保持一致<BR>
#define&nbsp;MTDIDS_DEFAULT&nbsp;"nand0=nandflash0"<BR>
#define&nbsp;MTDPARTS_DEFAULT&nbsp;"mtdparts=nandflash0:192k(bootloader),"&nbsp;\<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"64k(params),"&nbsp;\<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"2m(kernel),"&nbsp;\<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"-(root)"<BR>
这个分区信息是必须传递给内核的吗，我试了一下，没有加这些也可以正常启动的啊？<BR>
二，我用的是256M的大页nandflash，照着您的小页nandflash修改方法支持yaffs2文件系统，居然也行，是不是在程序中有自动判断大页小页的代码啊，还是说我这只是一种巧合？<BR>
三，从SDRAM中把yaffs2文件系统搬移到nandflash中时，这个过程好像要比其它版本的（我指的是1.1.6）慢好多啊，这个问题不知博主注意了没？<BR>
最后再次感谢您的文章，让我们学到了不少知识！</PRE>
</TD></TR>
</TBODY></TABLE>

</TD>
</TR>
<TR><TD height="15" colspan="3"></TR>
</TBODY></TABLE>


</TD></TR>
<TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_buttom.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_buttom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>
<BR>
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="96%">
<TBODY><TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_top.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3" width="100%">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_top.gif" border="0" alt=""></TD>
</TR>
<TR><TD colspan="3" bgcolor="#F3F3F3" align="center">
<TABLE border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" width="700" align="center">

<TBODY><TR><TD style="color:#0000CC;" height="25">
　发表评论
</TD></TR>
<TR><TD height="25">
<IFRAME name="comment" src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/comment.htm" width="640" height="160" frameborder="0"></IFRAME>
 
</TD></TR>

</TBODY></TABLE>

</TD></TR>
<TR><TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_left_buttom.gif" border="0" alt=""></TD>
<TD bgcolor="#F3F3F3">
<TD width="7" height="7"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/w_right_buttom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>


</TD></TR><TR><TD width="11" height="11"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/g_left_bottom.gif" border="0" alt=""></TD>
<TD bgcolor="#DDDDDD">
<TD width="11" height="11"><IMG src="./嵌入式Linux之我行――u-boot-2009.08在2440上的移植详解（五） - Bootloader移植篇_files/g_right_bottom.gif" border="0" alt=""></TD>
</TR>
</TBODY></TABLE>
</TD></TR>
</TBODY></TABLE>



</BODY></HTML>